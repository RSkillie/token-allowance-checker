{"version":3,"sources":["features/editAllowance/EditAllowanceSlice.ts","components/AddressDisplay.tsx","features/allowancesList/TokenAllowanceItemActions.tsx","features/allowancesList/TokenAllowanceItem.tsx","features/allowancesList/TokenAllowancesItem.tsx","features/allowancesList/AllowancesListContainer.tsx","features/allowancesListFilter/AllowancesListFilter.tsx","features/editAllowance/EditAllowanceForm.tsx","features/editAllowance/EditAllowanceFormContainer.tsx","utils/erc20-decimals-conversion.ts","features/allowancesList/AllowanceLister.tsx","features/onboard/OnboardGate.tsx","features/addressInput/AddressInput.tsx","features/addressInput/AddressInputContainer.tsx","components/AddressExtractor.tsx","app/App.tsx","app/rootReducer.ts","app/store.ts","index.tsx","features/allowancesList/AllowancesListSlice.ts","features/transactionTracker/TransactionTrackerSlice.ts","features/addressInput/AddressSlice.ts","utils/wellKnownContracts.ts","features/tokenContracts/tokenContractsSlice.ts","features/onboard/onboardSlice.ts","../node_modules/web3-eth-accounts/src sync","features/balances/BalancesSlice.tsx"],"names":["editAllowanceSlice","createSlice","name","initialState","showModal","editAllowanceId","reducers","openEditAllowanceModal","state","action","allowanceId","payload","closeEditAllowanceModal","actions","AddressDisplay","contractName","ethAddress","address","ensName","esContractName","setClipboard","content","navigator","clipboard","writeText","then","console","log","Popup","mouseEnterDelay","trigger","Icon","circular","size","onClick","window","open","TokenAllowanceItemActions","transactionContent","actionContent","dispatch","useDispatch","allowance","useSelector","allowances","allowancesById","transaction","editTransactionId","transactions","transactionsById","undefined","walletAddressId","addresses","icon","msg","header","transactionState","TransactionStates","CONFIRMED","transactionHash","FAILED","color","error","SUBMITTED","loading","INITIAL","editEnabled","ownerId","Button","compact","primary","disabled","event","preventDefault","unlimitedAllowance","BN","pow","subn","TokenAllowanceItem","allowanceElement","criticalAllowance","allowanceValue","allowanceValuesById","tokenContract","tokenContracts","contractsById","tokenContractId","spenderAddress","addressesById","spenderId","useEffect","QueryStates","QUERY_STATE_INITIAL","fetchAllowanceValueThunk","QUERY_STATE_RUNNING","Loader","active","inline","QUERY_STATE_COMPLETE","value","eq","gte","totalSupply","roundToDecimals","rounded","bnToDisplayString","decimals","QUERY_STATE_ERROR","Table","Row","key","Cell","negative","TokenAllowancesItem","tokenId","allowanceIds","tokenAddress","ownerBalance","balanceId","buildBalanceId","balances","balancesById","contractInstance","addBalanceThunk","Segment","raised","Placeholder","Header","Line","Paragraph","tokenDisplayString","queryState","bn2DisplayString","symbol","headline","rows","forEach","push","as","Subheader","basic","celled","selectable","HeaderCell","Body","AllowancesListContainer","message","showZeroAllowances","addressFilter","allowancesByTokenId","allowanceIdsByOwnerId","filter","isZero","filterString","toLowerCase","tokenContractAddress","addressId","includes","warn","map","_","groupBy","allowanceQueryStateByOwner","ownerAddress","items","Object","entries","entry","id","padded","textAlign","Message","warning","Content","currentPage","length","success","AllowancesListFilter","toggleShowZeroAllowances","addressFilterValue","handleAddressFilterChange","refresh","clearAddressFilter","Grid","verticalAlign","centered","columns","divided","Column","width","Input","label","placeholder","onChange","link","fluid","Checkbox","toggle","checked","title","EditAllowanceForm","tokenName","handleChange","currentAllowance","newAllowance","handleClose","handleSubmit","Modal","onClose","List","Item","Form","onSubmit","Field","required","tag","labelPosition","type","positive","EditAllowanceFormContainer","editAllowance","spender","useState","setNewAllowance","convertAllowanceToDisplaystring","useCallback","spenderENSName","e","target","parseFloat","newValue","base","substring","Error","toString","comps","split","whole","fraction","decimalsNumber","toNumber","wholeBN","fractionBN","wei","mul","add","neg","toBaseUnit","setAllowanceThunk","tokenSymbol","AllowanceLister","checkAddressId","showEditAllowanceModal","setShowZeroAllowances","setAddressFilter","document","fetchAllowancesThunk","Fragment","loadAllowances","OnboardGate","children","history","useHistory","onboard","onboardAPI","walletSelected","selectWallet","initialize","info","AddressInput","handleInput","addressInputStates","AddressInputContainer","web3","addressInputState","setAddressInputState","input","setInput","setAddress","a","validAddress","test","eth","ens","getAddress","resolvedAddress","widths","Group","AddressExtractor","addressFromParams","useParams","addressFromWallet","setCheckAddressThunk","clearCheckAddressId","App","GrantMessage","rel","href","HomepageHeading","inverted","vertical","Menu","fixed","Container","Link","to","position","text","style","marginTop","marginBottom","fontSize","path","paddingTop","container","stackable","floated","Divider","float","horizontal","pkg","version","rootReducer","combineReducers","onboardReducer","addressesReducer","tokenContractReducer","allowancesReducer","balancesReducer","editAllowanceReducer","transactionTrackerReducer","customizedMiddleware","getDefaultMiddleware","serializableCheck","ignoredActions","setOnboardAPI","setWeb3Instance","addContract","setAllowanceValue","addBalance","setBalanceValue","ignoredPaths","immutableCheck","ignore","store","configureStore","reducer","middleware","require","default","ReactDOM","render","getElementById","contract","topicHashApprove","eventABI","indexed","internalType","client","createDfuseClient","apiKey","network","defaultQueryStateByOwner","allowancesSlice","addAllowance","keys","prepare","buildAllowanceId","setQueryState","extraReducers","addAddress","addTransaction","transactionId","getState","owner","erc20Contract","ERC20Data","setProvider","currentProvider","cursor","numPageResults","badContracts","knownContracts","knownSpenders","graphql","variables","limit","query","response","errors","edges","data","searchTransactions","edgeIndex","node","index","matchingLogs","logEntry","topics","hash","decoded","abi","decodeLog","slice","parseInt","at","balanceOf","addContractThunk","addAddressThunk","fetchEtherscanNameThunk","pageInfo","endCursor","JSON","stringify","TransactionTrackerSlice","editAllowanceTransaction","updateTransaction","ResolvingStates","addressSlice","resolvingState","Initial","setResolvingState","setENSName","setCheckAddressId","setWalletAddressId","setEtherscanContractName","requestUrl","fetch","json","result","ContractName","Resolving","reverseENSLookupName","substr","resolver","ResolverContract","methods","namehash","call","reverseENS","Resolved","checkAddress","endsWith","setWalletAddressThunk","walletAddress","wellKnownContracts","1","tokenContractSlice","contractAddress","networkId","uuidv4","approve","from","tx","infuraApiKey","wallets","walletName","preferred","infuraKey","rpcUrl","appUrl","email","prevWalletAddressId","onboardSlice","setNetworkId","setPrevWalletAddressId","setWalletSelected","walletSelect","walletCheck","Onboard","dappId","subscriptions","wallet","Web3","provider","balance","heading","description","webpackEmptyContext","req","code","resolve","module","exports","balancesSlice","setBalanceQuerystate"],"mappings":"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","file":"static/js/main.2854e302.chunk.js","sourcesContent":["import { AllowanceId } from 'features/allowancesList/AllowancesListSlice'\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit'\n\ninterface EditAllowanceState {\n    showModal: boolean\n    editAllowanceId: AllowanceId\n}\n\nconst initialState: EditAllowanceState = {\n    showModal: false,\n    editAllowanceId: '',\n}\n\nconst editAllowanceSlice = createSlice({\n    name: 'editAllowance',\n    initialState: initialState,\n    reducers: {\n        openEditAllowanceModal(state, action: PayloadAction<AllowanceId>) {\n            const allowanceId = action.payload\n            state.showModal = true\n            state.editAllowanceId = allowanceId\n        },\n        closeEditAllowanceModal(state) {\n            state.showModal = false\n        },\n    },\n})\nexport const {\n    openEditAllowanceModal,\n    closeEditAllowanceModal,\n} = editAllowanceSlice.actions\nexport default editAllowanceSlice.reducer\n","import React from 'react'\nimport { Icon, Popup } from 'semantic-ui-react'\nimport { EthAddress } from 'features/addressInput/AddressSlice'\n\ninterface AddressDisplayProps {\n    ethAddress: EthAddress\n}\n\nconst AddressDisplay = ({ ethAddress }: AddressDisplayProps) => {\n    const { address, ensName, esContractName } = ethAddress\n    const setClipboard = (content: string) => {\n        navigator.clipboard.writeText(content).then(\n            function() {\n                /* clipboard successfully set */\n            },\n            function() {\n                console.log(`failed to set clipboard`)\n            }\n        )\n    }\n\n    let contractName\n    if (ensName) {\n        contractName = `Reverse ENS: ${ensName}`\n    } else if (esContractName) {\n        contractName = `Contract: ${esContractName}`\n    }\n\n    if (contractName) {\n        return (\n            <>\n                <div>\n                    <strong>{contractName}</strong>\n                </div>\n                <div>\n                    <small>\n                        {address}&nbsp;\n                        <Popup\n                            mouseEnterDelay={500}\n                            content={'Copy to clipboard'}\n                            trigger={\n                                <Icon\n                                    circular\n                                    name={'copy outline'}\n                                    size={'small'}\n                                    onClick={() => {\n                                        setClipboard(address)\n                                    }}\n                                />\n                            }\n                        />\n                        <Popup\n                            mouseEnterDelay={500}\n                            content={'View on Etherscan'}\n                            trigger={\n                                <Icon\n                                    circular\n                                    name={'external square'}\n                                    size={'small'}\n                                    onClick={() => {\n                                        window.open(\n                                            `https://etherscan.io/address/${address}`,\n                                            '_blank'\n                                        )\n                                    }}\n                                />\n                            }\n                        />\n                    </small>\n                </div>\n            </>\n        )\n    } else {\n        return (\n            <div>\n                {address}&nbsp;\n                <Popup\n                    mouseEnterDelay={500}\n                    content={'Copy to clipboard'}\n                    trigger={\n                        <Icon\n                            circular\n                            name={'copy outline'}\n                            size={'small'}\n                            onClick={() => {\n                                setClipboard(address)\n                            }}\n                        />\n                    }\n                />\n                <Popup\n                    mouseEnterDelay={500}\n                    content={'View on Etherscan'}\n                    trigger={\n                        <Icon\n                            circular\n                            name={'external square'}\n                            size={'small'}\n                            onClick={() => {\n                                window.open(\n                                    `https://etherscan.io/address/${address}`,\n                                    '_blank'\n                                )\n                            }}\n                        />\n                    }\n                />\n            </div>\n        )\n    }\n}\n\nexport default AddressDisplay\n","import { AllowanceId } from './AllowancesListSlice'\nimport React from 'react'\nimport { Button, Icon, Popup } from 'semantic-ui-react'\nimport { openEditAllowanceModal } from '../editAllowance/EditAllowanceSlice'\nimport { TransactionStates } from '../transactionTracker/TransactionTrackerSlice'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { RootState } from '../../app/rootReducer'\n\ninterface TokenAllowanceItemActionsProps {\n    allowanceId: AllowanceId\n}\nconst TokenAllowanceItemActions = ({\n    allowanceId,\n}: TokenAllowanceItemActionsProps) => {\n    const dispatch = useDispatch()\n    const allowance = useSelector(\n        (state: RootState) => state.allowances.allowancesById[allowanceId]\n    )\n    const transaction = useSelector((state: RootState) =>\n        allowance.editTransactionId\n            ? state.transactions.transactionsById[allowance.editTransactionId]\n            : undefined\n    )\n    const walletAddressId = useSelector(\n        (state: RootState) => state.addresses.walletAddressId\n    )\n\n    const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n        event.preventDefault()\n        dispatch(openEditAllowanceModal(allowanceId))\n    }\n\n    let transactionContent\n    if (transaction) {\n        let icon\n        let msg\n        let header\n        switch (transaction.transactionState) {\n            case TransactionStates.CONFIRMED:\n                icon = <Icon name={'check'} size={'large'} />\n                header = 'Transaction confirmed'\n                msg = `Transaction hash: ${transaction.transactionHash}`\n                break\n            case TransactionStates.FAILED:\n                icon = (\n                    <Icon\n                        name={'exclamation triangle'}\n                        color={'red'}\n                        size={'large'}\n                    />\n                )\n                header = 'Transaction failed'\n                msg = `${transaction.error}`\n                break\n            case TransactionStates.SUBMITTED:\n                icon = <Icon name={'spinner'} loading size={'large'} />\n                header = 'Transaction created'\n                msg = `Waiting for confirmation...`\n                break\n            case TransactionStates.INITIAL:\n            default:\n                icon = <Icon name={'question'} size={'large'} />\n                header = 'Transaction unknown'\n                msg = 'Tx state INITIAL'\n        }\n        transactionContent = (\n            <Popup header={header} content={msg} trigger={icon} />\n        )\n    }\n    let actionContent\n    if (transaction?.transactionState !== TransactionStates.SUBMITTED) {\n        const editEnabled = allowance.ownerId === walletAddressId\n        actionContent = (\n            <Popup\n                content={\n                    editEnabled\n                        ? 'edit allowance'\n                        : 'Only address owner can edit allowance'\n                }\n                trigger={\n                    <span>\n                        <Button\n                            icon={'edit'}\n                            size={'small'}\n                            compact\n                            primary\n                            disabled={!editEnabled}\n                            onClick={handleClick}\n                        />\n                    </span>\n                }\n            />\n        )\n    }\n\n    return (\n        <>\n            {actionContent}&nbsp;{transactionContent}\n        </>\n    )\n}\n\nexport default TokenAllowanceItemActions\n","import React, { useEffect } from 'react'\nimport {\n    AllowanceId,\n    fetchAllowanceValueThunk,\n    QueryStates,\n} from './AllowancesListSlice'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { RootState } from 'app/rootReducer'\nimport { Loader, Table } from 'semantic-ui-react'\nimport AddressDisplay from 'components/AddressDisplay'\nimport bnToDisplayString from '@triplespeeder/bn2string'\nimport BN from 'bn.js'\nimport TokenAllowanceItemActions from './TokenAllowanceItemActions'\n\ninterface TokenAllowanceItemProps {\n    allowanceId: AllowanceId\n}\n\nconst unlimitedAllowance = new BN(2).pow(new BN(256)).subn(1)\n\nconst TokenAllowanceItem = ({ allowanceId }: TokenAllowanceItemProps) => {\n    const dispatch = useDispatch()\n    const allowance = useSelector(\n        (state: RootState) => state.allowances.allowancesById[allowanceId]\n    )\n    const allowanceValue = useSelector(\n        (state: RootState) => state.allowances.allowanceValuesById[allowanceId]\n    )\n    const tokenContract = useSelector(\n        (state: RootState) =>\n            state.tokenContracts.contractsById[allowance.tokenContractId]\n    )\n    const spenderAddress = useSelector(\n        (state: RootState) => state.addresses.addressesById[allowance.spenderId]\n    )\n    // lazy-load allowance value\n    useEffect(() => {\n        if (allowanceValue.state === QueryStates.QUERY_STATE_INITIAL) {\n            dispatch(fetchAllowanceValueThunk(allowanceId))\n        }\n    }, [allowanceValue, allowanceId, dispatch])\n\n    let allowanceElement, criticalAllowance\n    switch (allowanceValue.state) {\n        case QueryStates.QUERY_STATE_RUNNING:\n            allowanceElement = <Loader active inline size={'mini'} />\n            break\n        case QueryStates.QUERY_STATE_COMPLETE:\n            criticalAllowance =\n                allowanceValue.value.eq(unlimitedAllowance) ||\n                allowanceValue.value.gte(tokenContract.totalSupply)\n            if (criticalAllowance) {\n                allowanceElement = <em>unlimited</em>\n            } else {\n                const roundToDecimals = new BN('2')\n                const { /*precise,*/ rounded } = bnToDisplayString({\n                    value: allowanceValue.value,\n                    decimals: tokenContract.decimals,\n                    roundToDecimals,\n                })\n                allowanceElement = <span>{rounded}</span>\n            }\n            break\n        case QueryStates.QUERY_STATE_ERROR:\n            allowanceElement = <span>error</span>\n            break\n        case QueryStates.QUERY_STATE_INITIAL:\n        default:\n            allowanceElement = ''\n    }\n\n    return (\n        <Table.Row key={`${allowanceId}`}>\n            <Table.Cell>\n                <AddressDisplay ethAddress={spenderAddress} />\n            </Table.Cell>\n            <Table.Cell negative={criticalAllowance}>\n                {allowanceElement}\n            </Table.Cell>\n            <Table.Cell>\n                <TokenAllowanceItemActions allowanceId={allowanceId} />\n            </Table.Cell>\n        </Table.Row>\n    )\n}\n\nexport default TokenAllowanceItem\n","import React, { useEffect } from 'react'\nimport { Header, Segment, Table, Placeholder } from 'semantic-ui-react'\nimport AddressDisplay from '../../components/AddressDisplay'\nimport BN from 'bn.js'\nimport { AddressId } from '../addressInput/AddressSlice'\nimport { AllowanceId, QueryStates } from './AllowancesListSlice'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { RootState } from 'app/rootReducer'\nimport TokenAllowanceItem from './TokenAllowanceItem'\nimport { addBalanceThunk, buildBalanceId } from '../balances/BalancesSlice'\nimport bn2DisplayString from '@triplespeeder/bn2string'\n\ninterface TokenAllowanceItemProps {\n    tokenId: AddressId\n    ownerId: AddressId\n    allowanceIds: Array<AllowanceId>\n}\n\nconst TokenAllowancesItem = ({\n    tokenId,\n    ownerId,\n    allowanceIds,\n}: TokenAllowanceItemProps) => {\n    const dispatch = useDispatch()\n    const tokenContract = useSelector(\n        (state: RootState) => state.tokenContracts.contractsById[tokenId]\n    )\n    const tokenAddress = useSelector(\n        (state: RootState) => state.addresses.addressesById[tokenId]\n    )\n    const ownerBalance = useSelector((state: RootState) => {\n        const balanceId = buildBalanceId(ownerId, tokenId)\n        return state.balances.balancesById[balanceId]\n    })\n\n    // lazy-load owner balance when contract instance is available\n    useEffect(() => {\n        if (!ownerBalance && tokenContract?.contractInstance) {\n            dispatch(addBalanceThunk(ownerId, tokenId))\n        }\n    }, [ownerBalance, ownerId, tokenId, tokenContract, dispatch])\n\n    // return placeholder if contract is not yet loaded\n    if (!tokenContract) {\n        return (\n            <Segment raised>\n                <Placeholder>\n                    <Placeholder.Header>\n                        <Placeholder.Line />\n                        <Placeholder.Line />\n                    </Placeholder.Header>\n                    <Placeholder.Paragraph>\n                        <Placeholder.Line />\n                        <Placeholder.Line />\n                        <Placeholder.Line />\n                    </Placeholder.Paragraph>\n                </Placeholder>\n            </Segment>\n        )\n    }\n\n    let tokenDisplayString = tokenContract.name\n    if (tokenDisplayString === '') {\n        tokenDisplayString = `Unnamed ERC20`\n    }\n    const roundToDecimals = new BN(2)\n    if (\n        !ownerBalance ||\n        ownerBalance.queryState === QueryStates.QUERY_STATE_RUNNING\n    ) {\n        tokenDisplayString += ` (current balance: loading...)`\n    } else {\n        const { rounded } = bn2DisplayString({\n            value: ownerBalance.value,\n            decimals: tokenContract.decimals,\n            roundToDecimals,\n        })\n        tokenDisplayString += ` (current balance: ${rounded} ${tokenContract.symbol})`\n    }\n    const headline = <div>{tokenDisplayString}</div>\n\n    // populate rows with one entry per allowance from allowanceIds\n    const rows: Array<React.ReactNode> = []\n    allowanceIds.forEach(allowanceId => {\n        rows.push(\n            <TokenAllowanceItem key={allowanceId} allowanceId={allowanceId} />\n        )\n    })\n\n    return (\n        <Segment raised>\n            <Header as={'h3'}>\n                {headline}\n                <Header.Subheader>\n                    <AddressDisplay ethAddress={tokenAddress} />\n                </Header.Subheader>\n            </Header>\n            <Table basic={'very'} celled selectable>\n                <Table.Header>\n                    <Table.Row>\n                        <Table.HeaderCell>Spender</Table.HeaderCell>\n                        <Table.HeaderCell>Allowance</Table.HeaderCell>\n                        <Table.HeaderCell>Action</Table.HeaderCell>\n                    </Table.Row>\n                </Table.Header>\n                <Table.Body>{rows}</Table.Body>\n            </Table>\n        </Segment>\n    )\n}\n\nexport default TokenAllowancesItem\n","import React from 'react'\nimport { useSelector } from 'react-redux'\nimport _ from 'lodash'\nimport { RootState } from '../../app/rootReducer'\nimport TokenAllowancesItem from './TokenAllowancesItem'\nimport { QueryStates } from './AllowancesListSlice'\nimport { Segment, Message, Icon } from 'semantic-ui-react'\nimport { AddressId } from '../addressInput/AddressSlice'\n\ninterface AllowancesListContainerProps {\n    ownerId: AddressId\n    showZeroAllowances: boolean\n    addressFilter: string\n}\n\nconst AllowancesListContainer = ({\n    ownerId,\n    showZeroAllowances,\n    addressFilter,\n}: AllowancesListContainerProps) => {\n    const allowancesByTokenId = useSelector((state: RootState) => {\n        let candidates\n        if (showZeroAllowances && addressFilter === '') {\n            // no filter required, just return all IDs.\n            candidates = state.allowances.allowanceIdsByOwnerId[ownerId]\n        } else {\n            // apply filter\n            candidates = state.allowances.allowanceIdsByOwnerId[ownerId].filter(\n                allowanceId => {\n                    const allowance =\n                        state.allowances.allowancesById[allowanceId]\n                    if (!showZeroAllowances) {\n                        const allowanceValue =\n                            state.allowances.allowanceValuesById[allowanceId]\n                        const isZeroAllowance =\n                            allowanceValue.state ===\n                                QueryStates.QUERY_STATE_COMPLETE &&\n                            allowanceValue.value.isZero()\n                        if (isZeroAllowance) {\n                            return false\n                        }\n                    }\n                    if (addressFilter) {\n                        const filterString = addressFilter.toLowerCase()\n                        const tokenContract =\n                            state.tokenContracts.contractsById[\n                                allowance.tokenContractId\n                            ]\n                        if (tokenContract) {\n                            const tokenContractAddress =\n                                state.addresses.addressesById[\n                                    tokenContract.addressId\n                                ]\n                            const matchedFilter =\n                                tokenContract.name\n                                    .toLowerCase()\n                                    .includes(filterString) ||\n                                tokenContract.symbol\n                                    .toLowerCase()\n                                    .includes(filterString) ||\n                                tokenContractAddress.address\n                                    .toLowerCase()\n                                    .includes(filterString) ||\n                                tokenContractAddress.ensName\n                                    ?.toLowerCase()\n                                    .includes(filterString)\n                            if (!matchedFilter) {\n                                return false\n                            }\n                        } else {\n                            console.warn(\n                                `No tokencontract for ${allowance.tokenContractId}`\n                            )\n                        }\n                    }\n                    return true\n                }\n            )\n        }\n        // get all allowances of owner\n        const allowances = candidates.map(\n            allowanceId => state.allowances.allowancesById[allowanceId]\n        )\n        // group allowances by tokenID\n        return _.groupBy(allowances, 'tokenContractId')\n    })\n    const queryState = useSelector(\n        (state: RootState) =>\n            state.allowances.allowanceQueryStateByOwner[ownerId]\n    )\n    const ownerAddress = useSelector(\n        (state: RootState) => state.addresses.addressesById[ownerId]\n    )\n\n    if (!queryState) {\n        console.log(`No querystate available for ${ownerId}`)\n        return null\n    }\n\n    let message\n    const items: Array<React.ReactNode> = []\n    for (const entry of Object.entries(allowancesByTokenId)) {\n        const tokenId = entry[0]\n        const allowanceIds = entry[1].map(allowance => allowance.id)\n        items.push(\n            <TokenAllowancesItem\n                key={tokenId}\n                tokenId={tokenId}\n                ownerId={ownerId}\n                allowanceIds={allowanceIds}\n            />\n        )\n    }\n\n    switch (queryState.state) {\n        case QueryStates.QUERY_STATE_RUNNING:\n            message = (\n                <Segment basic padded='very' textAlign={'center'}>\n                    <Message icon warning size={'huge'}>\n                        <Icon name='circle notched' loading />\n                        <Message.Content>\n                            <Message.Header>Loading events</Message.Header>\n                            <div>\n                                Querying dfuse API for ERC20 Approvals, getting\n                                page {queryState.currentPage + 1}...\n                            </div>\n                        </Message.Content>\n                    </Message>\n                </Segment>\n            )\n            break\n        case QueryStates.QUERY_STATE_ERROR:\n            message = (\n                <Segment basic padded='very' textAlign={'center'}>\n                    <Message error icon size={'huge'}>\n                        <Icon name='exclamation triangle' />\n                        <Message.Content>\n                            <Message.Header>Error</Message.Header>\n                            {queryState.error}\n                        </Message.Content>\n                    </Message>\n                </Segment>\n            )\n            break\n        case QueryStates.QUERY_STATE_COMPLETE:\n            if (items.length === 0) {\n                message = (\n                    <Segment basic padded='very' textAlign={'center'}>\n                        <Message success icon size={'huge'}>\n                            <Icon name='info' />\n                            <Message.Content>\n                                <Message.Header>No Approvals</Message.Header>\n                                {ownerAddress.ensName ??\n                                    ownerAddress.address}{' '}\n                                has no Approvals.\n                            </Message.Content>\n                        </Message>\n                    </Segment>\n                )\n            }\n            break\n        case QueryStates.QUERY_STATE_INITIAL:\n        default:\n            return <div>Unhandled state!</div>\n    }\n\n    return (\n        <>\n            {message}\n            {items}\n        </>\n    )\n}\n\nexport default AllowancesListContainer\n","import React from 'react'\nimport {\n    Checkbox,\n    Grid,\n    Icon,\n    Input,\n    Button,\n    ButtonProps,\n} from 'semantic-ui-react'\nimport { InputOnChangeData } from 'semantic-ui-react/dist/commonjs/elements/Input/Input'\nimport { CheckboxProps } from 'semantic-ui-react/dist/commonjs/modules/Checkbox/Checkbox'\n\ninterface AllowancesListFilterProps {\n    addressFilterValue: string\n    showZeroAllowances: boolean\n    toggleShowZeroAllowances: (\n        event: React.FormEvent<HTMLInputElement>,\n        data: CheckboxProps\n    ) => void\n    handleAddressFilterChange: (\n        event: React.ChangeEvent<HTMLInputElement>,\n        data: InputOnChangeData\n    ) => void\n    clearAddressFilter: (input: void) => void\n    refresh: (event: React.MouseEvent, data: ButtonProps) => void\n}\n\nconst AllowancesListFilter = ({\n    showZeroAllowances,\n    toggleShowZeroAllowances,\n    addressFilterValue,\n    handleAddressFilterChange,\n    refresh,\n    clearAddressFilter,\n}: AllowancesListFilterProps) => {\n    return (\n        <Grid\n            verticalAlign='middle'\n            centered\n            textAlign={'center'}\n            columns={2}\n            divided\n        >\n            <Grid.Row>\n                <Grid.Column width={9}>\n                    <Input\n                        label='Tokenfilter'\n                        name='filter'\n                        placeholder='Enter name, symbol or contract address'\n                        onChange={handleAddressFilterChange}\n                        value={addressFilterValue}\n                        icon={\n                            <Icon\n                                name='eraser'\n                                circular\n                                link\n                                onClick={clearAddressFilter}\n                            />\n                        }\n                        fluid\n                    />\n                </Grid.Column>\n                <Grid.Column width={6}>\n                    <Checkbox\n                        toggle\n                        label='Include zero allowances'\n                        checked={showZeroAllowances}\n                        onChange={toggleShowZeroAllowances}\n                    />\n                </Grid.Column>\n                <Grid.Column width={1}>\n                    <Button\n                        circular\n                        icon={'refresh'}\n                        onClick={refresh}\n                        title={'Refresh allowances'}\n                        size={'small'}\n                        compact\n                    />\n                </Grid.Column>\n            </Grid.Row>\n        </Grid>\n    )\n}\n\nexport default AllowancesListFilter\n","import React from 'react'\nimport { Form, Grid, Header, Input, Message, Modal } from 'semantic-ui-react'\n\ninterface EditAllowanceFormProps {\n    tokenName: string\n    tokenSymbol: string\n    tokenAddress: string\n    spenderAddress: string\n    spenderENSName: string\n    currentAllowance: string\n    newAllowance: string\n    handleChange: (e: React.FormEvent<EventTarget>) => void\n    handleClose: () => void\n    handleSubmit: () => void\n}\n\nconst EditAllowanceForm = ({\n    tokenName,\n    handleChange,\n    tokenAddress,\n    spenderAddress,\n    currentAllowance,\n    newAllowance,\n    handleClose,\n    handleSubmit,\n}: EditAllowanceFormProps) => {\n    let headline = tokenName\n    if (headline === '') {\n        headline = `Unnamed ERC20 at ${tokenAddress}`\n    }\n    return (\n        <Modal open={true} size={'small'} onClose={handleClose}>\n            <Header>Edit Allowance</Header>\n            <Modal.Content>\n                <Message size={'huge'}>\n                    <Message.List>\n                        <Message.Item>Token: {headline}</Message.Item>\n                        <Message.Item>Spender: {spenderAddress}</Message.Item>\n                        <Message.Item>\n                            Current allowance: {currentAllowance}\n                        </Message.Item>\n                    </Message.List>\n                </Message>\n                <Form size={'huge'} onSubmit={handleSubmit}>\n                    <Form.Field required>\n                        <Input\n                            label={{\n                                tag: true,\n                                content: 'Enter new allowance',\n                            }}\n                            labelPosition='right'\n                            placeholder='Enter amount'\n                            type={'number'}\n                            name={'newAllowance'}\n                            onChange={handleChange}\n                            value={newAllowance}\n                        />\n                    </Form.Field>\n                    <Grid columns={2}>\n                        <Grid.Row>\n                            <Grid.Column>\n                                <Form.Button\n                                    type={'button'}\n                                    fluid\n                                    size={'huge'}\n                                    negative\n                                    onClick={handleClose}\n                                >\n                                    Cancel\n                                </Form.Button>\n                            </Grid.Column>\n                            <Grid.Column>\n                                <Form.Button\n                                    type={'submit'}\n                                    fluid\n                                    size={'huge'}\n                                    positive\n                                >\n                                    Set allowance\n                                </Form.Button>\n                            </Grid.Column>\n                        </Grid.Row>\n                    </Grid>\n                </Form>\n            </Modal.Content>\n        </Modal>\n    )\n}\n\nexport default EditAllowanceForm\n","import React, { useCallback, useState } from 'react'\nimport bnToDisplayString from '@triplespeeder/bn2string'\nimport { toBaseUnit } from '../../utils/erc20-decimals-conversion'\nimport EditAllowanceForm from './EditAllowanceForm'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { RootState } from 'app/rootReducer'\nimport BN from 'bn.js'\nimport { closeEditAllowanceModal } from './EditAllowanceSlice'\nimport { setAllowanceThunk } from '../tokenContracts/tokenContractsSlice'\n\nconst EditAllowanceFormContainer = () => {\n    const dispatch = useDispatch()\n    const allowance = useSelector(\n        (state: RootState) =>\n            state.allowances.allowancesById[state.editAllowance.editAllowanceId]\n    )\n    const allowanceValue = useSelector(\n        (state: RootState) =>\n            state.allowances.allowanceValuesById[\n                state.editAllowance.editAllowanceId\n            ]\n    )\n    const tokenContract = useSelector(\n        (state: RootState) =>\n            state.tokenContracts.contractsById[allowance.tokenContractId]\n    )\n    const spender = useSelector(\n        (state: RootState) => state.addresses.addressesById[allowance.spenderId]\n    )\n    const [newAllowance, setNewAllowance] = useState('0')\n\n    const convertAllowanceToDisplaystring = useCallback(() => {\n        if (allowanceValue.value.gte(tokenContract.totalSupply)) {\n            return 'unlimited'\n        } else {\n            const allowanceDisplay = bnToDisplayString({\n                value: allowanceValue.value,\n                decimals: tokenContract.decimals,\n                roundToDecimals: new BN(2),\n            })\n            return allowanceDisplay.rounded\n        }\n    }, [\n        allowanceValue.value,\n        tokenContract.totalSupply,\n        tokenContract.decimals,\n    ])\n\n    const handleAllowanceInputChange = (e: React.FormEvent<EventTarget>) => {\n        let { value } = e.target as HTMLInputElement\n        console.log(`handleChange: ${value}`)\n        if (parseFloat(value) < 0) {\n            value = '0'\n        }\n        setNewAllowance(value)\n    }\n\n    const handleClose = () => {\n        dispatch(closeEditAllowanceModal())\n    }\n\n    const handleSubmit = () => {\n        console.log(`Submitted new allowance: ${newAllowance}`)\n        // convert 'newAllowance' number to token baseunit\n        const newValue = toBaseUnit(newAllowance, tokenContract.decimals)\n        dispatch(closeEditAllowanceModal())\n        dispatch(\n            setAllowanceThunk(\n                tokenContract.addressId,\n                spender.address,\n                newValue,\n                allowance.id\n            )\n        )\n    }\n\n    return (\n        <EditAllowanceForm\n            newAllowance={newAllowance}\n            currentAllowance={convertAllowanceToDisplaystring()}\n            tokenAddress={tokenContract.addressId}\n            handleClose={handleClose}\n            spenderAddress={spender.address}\n            spenderENSName={spender.ensName || ''}\n            tokenName={tokenContract.name}\n            handleChange={handleAllowanceInputChange}\n            handleSubmit={handleSubmit}\n            tokenSymbol={tokenContract.symbol}\n        />\n    )\n}\n\nexport default EditAllowanceFormContainer\n","import BN from 'bn.js'\n\nexport function toBaseUnit(value: string, decimals: BN) {\n    const ten = new BN(10)\n    const base = ten.pow(decimals)\n\n    // Is it negative?\n    const negative = value.substring(0, 1) === '-'\n    if (negative) {\n        value = value.substring(1)\n    }\n\n    if (value === '.') {\n        throw new Error(\n            `Invalid value ${value} cannot be converted to` +\n                ` base unit with ${decimals.toString()} decimals.`\n        )\n    }\n\n    // Split it into a whole and fractional part\n    const comps = value.split('.')\n    if (comps.length > 2) {\n        throw new Error('Too many decimal points')\n    }\n    let whole = comps[0]\n    let fraction = comps[1]\n\n    if (!whole) {\n        whole = '0'\n    }\n    if (!fraction) {\n        fraction = '0'\n    }\n    const decimalsNumber = decimals.toNumber()\n    if (fraction.length > decimalsNumber) {\n        throw new Error('Too many decimal places')\n    }\n\n    while (fraction.length < decimalsNumber) {\n        fraction += '0'\n    }\n\n    const wholeBN = new BN(whole)\n    const fractionBN = new BN(fraction)\n    let wei = wholeBN.mul(base).add(fractionBN)\n\n    if (negative) {\n        wei = wei.neg()\n    }\n\n    return new BN(wei.toString(10), 10)\n}\n","import React, { useEffect, useState } from 'react'\nimport 'semantic-ui-css/semantic.min.css'\nimport { Segment } from 'semantic-ui-react'\nimport AllowancesListContainer from './AllowancesListContainer'\nimport AllowancesListFilter from '../allowancesListFilter/AllowancesListFilter'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { RootState } from '../../app/rootReducer'\nimport { fetchAllowancesThunk, QueryStates } from './AllowancesListSlice'\nimport EditAllowanceFormContainer from '../editAllowance/EditAllowanceFormContainer'\n\nconst AllowanceLister = () => {\n    const dispatch = useDispatch()\n    const address = useSelector((state: RootState) => {\n        if (state.addresses.checkAddressId) {\n            return state.addresses.addressesById[state.addresses.checkAddressId]\n        } else {\n            return undefined\n        }\n    })\n    const queryState = useSelector((state: RootState) => {\n        if (address)\n            return state.allowances.allowanceQueryStateByOwner[address.address]\n        else return undefined\n    })\n    const showEditAllowanceModal = useSelector(\n        (state: RootState) => state.editAllowance.showModal\n    )\n\n    const [showZeroAllowances, setShowZeroAllowances] = useState(true)\n    const [addressFilter, setAddressFilter] = useState('')\n\n    const toggleShowZeroAllowances = () => {\n        setShowZeroAllowances(!showZeroAllowances)\n    }\n\n    const clearAddressFilter = () => {\n        setAddressFilter('')\n    }\n\n    const handleAddressFilterChange = (e: React.FormEvent<EventTarget>) => {\n        const { value } = e.target as HTMLInputElement\n        setAddressFilter(value)\n    }\n\n    useEffect(() => {\n        document.title = `TAC - ${address?.ensName ?? address?.address}`\n    }, [address])\n\n    useEffect(() => {\n        if (\n            queryState &&\n            queryState.state === QueryStates.QUERY_STATE_INITIAL\n        ) {\n            if (address) dispatch(fetchAllowancesThunk(address.address))\n        }\n    }, [queryState, dispatch, address])\n\n    const loadAllowances = () => {\n        if (address) {\n            console.log(\n                `Starting query for \"${address?.ensName ?? address?.address}\"`\n            )\n            dispatch(fetchAllowancesThunk(address.address))\n        }\n    }\n\n    const handleRefreshClick = () => {\n        loadAllowances()\n    }\n\n    if (!address) {\n        return <div>No address set</div>\n    }\n\n    return (\n        <React.Fragment>\n            <Segment basic>\n                <h2>Allowances of {address?.ensName ?? address?.address}:</h2>\n            </Segment>\n            <AllowancesListFilter\n                showZeroAllowances={showZeroAllowances}\n                toggleShowZeroAllowances={toggleShowZeroAllowances}\n                addressFilterValue={addressFilter}\n                handleAddressFilterChange={handleAddressFilterChange}\n                clearAddressFilter={clearAddressFilter}\n                refresh={handleRefreshClick}\n            />\n            <AllowancesListContainer\n                ownerId={address.address}\n                showZeroAllowances={showZeroAllowances}\n                addressFilter={addressFilter}\n            />\n            {showEditAllowanceModal && <EditAllowanceFormContainer />}\n        </React.Fragment>\n    )\n}\n\nexport default AllowanceLister\n","import React, { useEffect } from 'react'\nimport { Icon, Message, Segment } from 'semantic-ui-react'\nimport { useHistory } from 'react-router-dom'\nimport { useSelector, useDispatch } from 'react-redux'\nimport { RootState } from '../../app/rootReducer'\nimport { initialize, selectWallet } from './onboardSlice'\n\ninterface OnboardGateProps {\n    children?: React.ReactNode\n}\nconst OnboardGate = ({ children }: OnboardGateProps) => {\n    const history = useHistory()\n    const dispatch = useDispatch()\n    const { onboardAPI, walletSelected } = useSelector(\n        (state: RootState) => state.onboard\n    )\n\n    useEffect(() => {\n        if (!onboardAPI) {\n            console.log(`OnboardGate: Dispatching initialize()`)\n            dispatch(initialize(history))\n        } else if (!walletSelected) {\n            console.log(`OnboardGate: Dispatching selectWallet`)\n            dispatch(selectWallet(history))\n        }\n    }, [onboardAPI, walletSelected, dispatch, history])\n\n    if (walletSelected) {\n        return <React.Fragment>{children}</React.Fragment>\n    } else {\n        return (\n            <Segment basic padded='very' textAlign={'center'}>\n                <Message info icon size={'huge'}>\n                    <Icon name='spinner' loading />\n                    <Message.Content>\n                        <Message.Header>Waiting for wallet</Message.Header>\n                        Please complete wallet selection.\n                    </Message.Content>\n                </Message>\n            </Segment>\n        )\n    }\n}\n\nexport default OnboardGate\n","import React from 'react'\nimport { Form, Input } from 'semantic-ui-react'\n\ninterface AddressInputProps {\n    value: string\n    loading: boolean\n    error: boolean\n    success: boolean\n    handleInput: (input: string) => void\n}\n\nconst AddressInput = ({\n    handleInput,\n    loading,\n    error,\n    value,\n    success,\n}: AddressInputProps) => {\n    const handleChange = (e: React.FormEvent<EventTarget>) => {\n        const { value } = e.target as HTMLInputElement\n        handleInput(value)\n    }\n\n    return (\n        <Form.Field inline width={14}>\n            <Input\n                placeholder='Address or ENS Name'\n                error={error}\n                loading={loading}\n                onChange={handleChange}\n                value={value}\n                type={'text'}\n                action={{\n                    type: 'Submit',\n                    disabled: !success,\n                    content: 'Go!',\n                    positive: true,\n                }}\n                label={'Enter address/ENS name or select in wallet'}\n            />\n        </Form.Field>\n    )\n}\n\nexport default AddressInput\n","import React, { useState, useEffect } from 'react'\nimport AddressInput from './AddressInput'\nimport { useHistory } from 'react-router-dom'\nimport { Form, Grid } from 'semantic-ui-react'\nimport { useSelector } from 'react-redux'\nimport { RootState } from '../../app/rootReducer'\n\nexport const addressInputStates = {\n    ADDRESS_INITIAL: 'address_initial', // no user interaction\n    ADDRESS_RESOLVING: 'address_resolving', // valid ENS name entered, waiting for resolving\n    ADDRESS_VALID: 'address_valid', // got a valid address\n    ADDRESS_INVALID: 'address_invalid',\n}\n\nconst AddressInputContainer = () => {\n    const { web3 } = useSelector((state: RootState) => state.onboard)\n    const { checkAddressId } = useSelector(\n        (state: RootState) => state.addresses\n    )\n\n    const history = useHistory()\n    const [addressInputState, setAddressInputState] = useState(\n        addressInputStates.ADDRESS_INITIAL\n    )\n    const [input, setInput] = useState('')\n    const [address, setAddress] = useState('')\n\n    // verify address input\n    useEffect(() => {\n        const handleInput = async () => {\n            if (input.length === 0) {\n                setAddressInputState(addressInputStates.ADDRESS_INITIAL)\n            } else {\n                // check for valid input (raw address and ENS name)\n                const validAddress = /^(0x)?[0-9a-f]{40}$/i.test(input)\n                const validENSName = /.*\\.eth$/i.test(input)\n                if (validENSName && web3) {\n                    // resolve entered ENS name\n                    setAddressInputState(addressInputStates.ADDRESS_RESOLVING)\n                    try {\n                        const resolvedAddress = await web3.eth.ens.getAddress(\n                            input\n                        )\n                        console.log(`Resolved ${input} to ${resolvedAddress}`)\n                        setAddressInputState(addressInputStates.ADDRESS_VALID)\n                        setAddress(resolvedAddress)\n                    } catch (e) {\n                        console.log('Could not resolve ' + input)\n                        setAddressInputState(addressInputStates.ADDRESS_INVALID)\n                    }\n                } else if (validAddress) {\n                    setAddress(input)\n                    setAddressInputState(addressInputStates.ADDRESS_VALID)\n                } else {\n                    setAddressInputState(addressInputStates.ADDRESS_INVALID)\n                }\n            }\n        }\n        handleInput()\n    }, [input, setAddress, web3])\n\n    // keep address input field in sync with address provided by wallet or url\n    useEffect(() => {\n        if (checkAddressId) {\n            setInput(checkAddressId)\n        }\n    }, [checkAddressId])\n\n    const error = addressInputState === addressInputStates.ADDRESS_INVALID\n    const loading = addressInputState === addressInputStates.ADDRESS_RESOLVING\n    const success = addressInputState === addressInputStates.ADDRESS_VALID\n\n    const handleSubmit = () => {\n        if (success) {\n            history.push(`/address/${address}`)\n        }\n    }\n\n    return (\n        <Grid textAlign={'center'} centered columns={1}>\n            <Grid.Row>\n                <Grid.Column width={14}>\n                    <Form\n                        size={'huge'}\n                        onSubmit={handleSubmit}\n                        error={error}\n                        success={success}\n                        widths={'equal'}\n                    >\n                        <Form.Group>\n                            <AddressInput\n                                handleInput={setInput}\n                                value={input}\n                                error={error}\n                                success={success}\n                                loading={loading}\n                            />\n                        </Form.Group>\n                    </Form>\n                </Grid.Column>\n            </Grid.Row>\n        </Grid>\n    )\n}\n\nexport default AddressInputContainer\n","import React, { FunctionComponent, useEffect } from 'react'\nimport { useHistory, useParams } from 'react-router-dom'\nimport {\n    clearCheckAddressId,\n    setCheckAddressThunk,\n} from '../features/addressInput/AddressSlice'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { RootState } from '../app/rootReducer'\n\ninterface AddressExtractorProps {\n    children?: React.ReactNode\n}\n\nconst AddressExtractor: FunctionComponent = ({\n    children,\n}: AddressExtractorProps) => {\n    const dispatch = useDispatch()\n    const history = useHistory()\n    const { address: addressFromParams } = useParams()\n    const { walletAddressId: addressFromWallet } = useSelector(\n        (state: RootState) => state.addresses\n    )\n    const { web3 } = useSelector((state: RootState) => state.onboard)\n\n    useEffect(() => {\n        if (addressFromParams) {\n            if (web3) {\n                console.log(\n                    `AddressExtractor: Setting new address ${addressFromParams}`\n                )\n                dispatch(setCheckAddressThunk(addressFromParams.toLowerCase()))\n            }\n        } else if (addressFromWallet) {\n            console.log(\n                `AddressExtractor: no address in params. Falling back to walletAddress ${addressFromWallet}`\n            )\n            history.push(`/address/${addressFromWallet}`)\n        } else {\n            console.log(`AddressExtractor: Clearing checkAddressId`)\n            dispatch(clearCheckAddressId())\n        }\n    }, [addressFromParams, addressFromWallet, dispatch, history, web3])\n\n    return <React.Fragment>{children}</React.Fragment>\n}\n\nexport default AddressExtractor\n","import React from 'react'\nimport './App.css'\nimport { HashRouter as Router, Link, Route, Switch } from 'react-router-dom'\nimport {\n    Button,\n    Container,\n    Divider,\n    Grid,\n    Header,\n    Icon,\n    List,\n    Menu,\n    Popup,\n    Segment,\n    Message,\n} from 'semantic-ui-react'\nimport AllowanceLister from '../features/allowancesList/AllowanceLister'\nimport OnboardGate from '../features/onboard/OnboardGate'\nimport AddressInputContainer from '../features/addressInput/AddressInputContainer'\nimport pkg from '../../package.json'\nimport AddressExtractor from '../components/AddressExtractor'\n\nconst App: React.FC = () => {\n    const GrantMessage = (\n        <Message color={'yellow'} size={'big'} icon>\n            <Icon name={'hand point right'} />\n            <Message.Content>\n                <Message.Header>\n                    Gitcoins <em>$250k Matching Round</em> is now live until\n                    2020-04-07!\n                </Message.Header>\n                <div>\n                    Do you like this project? Contribute to the{' '}\n                    <strong>gitcoin grant</strong> to support the ongoing\n                    development of Token Allowance Checker!\n                </div>\n                <div>\n                    <strong>\n                        -&gt;{' '}\n                        <a\n                            target={'_blank'}\n                            rel={'noopener noreferrer'}\n                            href={\n                                'https://gitcoin.co/grants/480/token-allowance-checker?tab=description'\n                            }\n                        >\n                            Gitcoin Grant Page\n                        </a>{' '}\n                        &lt;-\n                    </strong>\n                </div>\n                <div>\n                    Direct donations are also welcome! Please use address{' '}\n                    <strong>tac.dappstar.eth</strong>.\n                </div>\n            </Message.Content>\n        </Message>\n    )\n\n    const HomepageHeading = (\n        <Segment inverted={false} textAlign='center' vertical>\n            <Menu fixed='top' inverted size='huge'>\n                <Container>\n                    <Menu.Item header as={Link} to='/'>\n                        <Icon name='home' size='big' /> Home\n                    </Menu.Item>\n                    <Menu.Item as={Link} to='/address/'>\n                        <Icon name='search' size='big' /> Check Allowances\n                    </Menu.Item>\n                    <Menu.Menu position='right'>\n                        <Menu.Item>\n                            <a\n                                href='https://github.com/TripleSpeeder/token-allowance-checker'\n                                title='github.com/TripleSpeeder/token-allowance-checker'\n                                target='_blank'\n                                rel='noopener noreferrer'\n                            >\n                                <Icon name='github' size='big' />\n                            </a>\n                        </Menu.Item>\n                    </Menu.Menu>\n                </Container>\n            </Menu>\n            <Container\n                text\n                style={{\n                    marginTop: '4em',\n                    marginBottom: '2em',\n                }}\n            >\n                <Header\n                    as='h1'\n                    inverted={false}\n                    style={{\n                        fontSize: '3em',\n                        marginTop: '0.5em',\n                    }}\n                >\n                    Token Allowance Checker\n                    <Header.Subheader>\n                        powered by{' '}\n                        <a\n                            href='https://www.dfuse.io/'\n                            rel='noopener noreferrer'\n                            target='_blank'\n                        >\n                            dfuse\n                        </a>\n                    </Header.Subheader>\n                </Header>\n            </Container>\n            <Container textAlign={'center'}>{GrantMessage}</Container>\n        </Segment>\n    )\n\n    return (\n        <Router>\n            {HomepageHeading}\n            <Switch>\n                <Route path={['/address/:address', '/address']}>\n                    <Container>\n                        <OnboardGate>\n                            <AddressExtractor>\n                                <Segment basic padded>\n                                    <AddressInputContainer />\n                                </Segment>\n                                <AllowanceLister />\n                            </AddressExtractor>\n                        </OnboardGate>\n                    </Container>\n                </Route>\n                <Route path='/'>\n                    <Segment basic vertical style={{ paddingTop: '4em' }}>\n                        <Grid container stackable verticalAlign='top'>\n                            <Grid.Row>\n                                <Grid.Column width={8}>\n                                    <Header as='h3' style={{ fontSize: '2em' }}>\n                                        Do you actually know who can spend your\n                                        tokens?\n                                    </Header>\n                                    <p style={{ fontSize: '1.33em' }}>\n                                        <em>Token Allowance Checker</em> helps\n                                        you keep track of which contracts you\n                                        have approved to spend your tokens.\n                                    </p>\n                                    <Header as='h3' style={{ fontSize: '2em' }}>\n                                        Control your approvals\n                                    </Header>\n                                    <p style={{ fontSize: '1.33em' }}>\n                                        <em>Token Allowance Checker</em> will\n                                        show you all approvals for\n                                        ERC20-compliant tokens, and the option\n                                        to change the approved amount - or\n                                        completely zero it.\n                                    </p>\n                                </Grid.Column>\n                                <Grid.Column floated='right' width={7}>\n                                    <Header as='h3' style={{ fontSize: '2em' }}>\n                                        The unlimited approval problem\n                                    </Header>\n                                    <p style={{ fontSize: '1.33em' }}>\n                                        Many DApps have the habit of requiring\n                                        you to approve effectively unlimited\n                                        amount of tokens. This helps improving\n                                        the user experience, as you only have to\n                                        sign off an approval once and it will be\n                                        enough for all future transactions.\n                                    </p>\n                                    <p style={{ fontSize: '1.33em' }}>\n                                        However this also means that the DApp\n                                        (or the person/entity controlling it)\n                                        can at any time transfer{' '}\n                                        <em>all of your tokens</em>, without\n                                        requiring any further approval.\n                                    </p>\n                                    <p style={{ fontSize: '1.33em' }}>\n                                        In addition, there is no concept of\n                                        expiring approvals. Once approved, the\n                                        approval will remain forever. If you do\n                                        not trust a DApp or its operators\n                                        anymore, there is usually no easy way to\n                                        remove the approval.\n                                    </p>\n                                </Grid.Column>\n                            </Grid.Row>\n                        </Grid>\n                    </Segment>\n                    <Segment basic textAlign='center'>\n                        <Button primary as={Link} to='/address/' size='massive'>\n                            Check Allowances\n                            <Icon name='arrow right' />\n                        </Button>\n                    </Segment>\n                </Route>\n            </Switch>\n            <Segment basic>\n                <Divider />\n                <Container textAlign='center'>\n                    <span style={{ fontSize: '1em', float: 'right' }}>\n                        <Icon name='copyright outline' /> Michael Bauer\n                    </span>\n                    <List horizontal>\n                        <List.Item\n                            as='a'\n                            href='https://twitter.com/TripleSpeeder'\n                            target='_blank'\n                        >\n                            <Popup\n                                content='@triplespeeder'\n                                trigger={<Icon size='big' name='twitter' />}\n                            />\n                        </List.Item>\n                        <List.Item\n                            as='a'\n                            href='https://t.me/triplespeeder'\n                            target='_blank'\n                        >\n                            <Popup\n                                content='@triplespeeder'\n                                trigger={<Icon size='big' name='telegram' />}\n                            />\n                        </List.Item>\n                        <List.Item as='a' href='mailto:michael@m-bauer.org'>\n                            <Popup\n                                content='michael@m-bauer.org'\n                                trigger={\n                                    <Icon size='big' name='mail outline' />\n                                }\n                            />\n                        </List.Item>\n                        <List.Item\n                            as='a'\n                            href='https://github.com/TripleSpeeder'\n                            target='_blank'\n                        >\n                            <Popup\n                                content='github.com/TripleSpeeder'\n                                trigger={<Icon size='big' name='github' />}\n                            />\n                        </List.Item>\n                        <List.Item\n                            as='a'\n                            href='https://www.reddit.com/u/TripleSpeeder'\n                            target='_blank'\n                        >\n                            <Popup\n                                content='u/TripleSpeeder'\n                                trigger={<Icon size='big' name='reddit' />}\n                            />\n                        </List.Item>\n                    </List>\n                    <span style={{ fontSize: '1em', float: 'left' }}>\n                        {pkg.version}\n                    </span>\n                </Container>\n            </Segment>\n        </Router>\n    )\n}\n\nexport default App\n","import { combineReducers } from '@reduxjs/toolkit'\nimport onboardReducer from 'features/onboard/onboardSlice'\nimport addressesReducer from 'features/addressInput/AddressSlice'\nimport tokenContractReducer from 'features/tokenContracts/tokenContractsSlice'\nimport allowancesReducer from 'features/allowancesList/AllowancesListSlice'\nimport balancesReducer from 'features/balances/BalancesSlice'\nimport editAllowanceReducer from 'features/editAllowance/EditAllowanceSlice'\nimport transactionTrackerReducer from 'features/transactionTracker/TransactionTrackerSlice'\n\nconst rootReducer = combineReducers({\n    onboard: onboardReducer,\n    addresses: addressesReducer,\n    tokenContracts: tokenContractReducer,\n    allowances: allowancesReducer,\n    balances: balancesReducer,\n    editAllowance: editAllowanceReducer,\n    transactions: transactionTrackerReducer,\n})\n\nexport type RootState = ReturnType<typeof rootReducer>\n\nexport default rootReducer\n","import { configureStore, Action, getDefaultMiddleware } from '@reduxjs/toolkit'\nimport { ThunkAction } from 'redux-thunk'\nimport rootReducer, { RootState } from './rootReducer'\nimport {\n    setOnboardAPI,\n    setWeb3Instance,\n} from '../features/onboard/onboardSlice'\nimport { addContract } from 'features/tokenContracts/tokenContractsSlice'\nimport { setAllowanceValue } from 'features/allowancesList/AllowancesListSlice'\nimport { setBalanceValue, addBalance } from 'features/balances/BalancesSlice'\n\nconst customizedMiddleware = getDefaultMiddleware({\n    serializableCheck: {\n        ignoredActions: [\n            setOnboardAPI.type,\n            setWeb3Instance.type,\n            addContract.type,\n            setAllowanceValue.type,\n            addBalance.type,\n            setBalanceValue.type,\n        ],\n        ignoredPaths: [\n            'onboard.web3',\n            'onboard.onboardAPI',\n            'tokenContracts.contractsById',\n            'allowances.allowanceValuesById',\n            'balances.balancesById',\n        ],\n    },\n    immutableCheck: {\n        ignore: [\n            'onboard.web3',\n            'onboard.onboardAPI',\n            'tokenContracts.contractsById',\n        ],\n    },\n})\n\nconst store = configureStore({\n    reducer: rootReducer,\n    middleware: customizedMiddleware,\n})\n\nif (process.env.NODE_ENV === 'development' && module.hot) {\n    module.hot.accept('./rootReducer', () => {\n        const newRootReducer = require('./rootReducer').default\n        store.replaceReducer(newRootReducer)\n    })\n}\n\nexport type AppDispatch = typeof store.dispatch\nexport type AppThunk = ThunkAction<void, RootState, unknown, Action<string>>\n\nexport default store\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Provider } from 'react-redux'\nimport store from './app/store'\nimport './index.css'\n\nconst render = () => {\n    const App = require('./app/App').default\n    ReactDOM.render(\n        <Provider store={store}>\n            <App />\n        </Provider>,\n        document.getElementById('root')\n    )\n}\n\nrender()\n\nif (process.env.NODE_ENV === 'development' && module.hot) {\n    module.hot.accept('./app/App', render)\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { AppDispatch, AppThunk } from '../../app/store'\nimport { addContractThunk } from 'features/tokenContracts/tokenContractsSlice'\nimport {\n    addAddressThunk,\n    AddressId,\n    EthAddressPayload,\n    addAddress,\n    fetchEtherscanNameThunk,\n} from '../addressInput/AddressSlice'\nimport BN from 'bn.js'\nimport { createDfuseClient } from '@dfuse/client'\nimport {\n    TransactionId,\n    addTransaction,\n    EditAllowanceTransaction,\n} from '../transactionTracker/TransactionTrackerSlice'\nimport ERC20Data from '@openzeppelin/contracts/build/contracts/ERC20Detailed.json'\nimport ERC20Detailed from '../../contracts'\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst contract = require('@truffle/contract')\n\nconst topicHashApprove =\n    '0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925'\nconst eventABI = [\n    {\n        indexed: true,\n        internalType: 'address',\n        name: 'owner',\n        type: 'address',\n    },\n    {\n        indexed: true,\n        internalType: 'address',\n        name: 'spender',\n        type: 'address',\n    },\n    {\n        indexed: false,\n        internalType: 'uint256',\n        name: 'value',\n        type: 'uint256',\n    },\n]\n\nconst client = createDfuseClient({\n    apiKey: 'web_085aeaac9c520204b1a9dcaa357e5460',\n    network: 'mainnet.eth.dfuse.io',\n})\nconst searchTransactions = `query ($query: String! $limit: Int64! $cursor: String) {\n      searchTransactions(\n        indexName: LOGS, \n        query: $query, \n        limit: $limit, \n        sort: DESC,\n        cursor: $cursor,\n      ) {\n        pageInfo {\n          endCursor\n        }\n        edges {\n          node {\n            hash\n            block {\n              number\n            }\n            matchingLogs {\n              data\n              topics\n              address\n            }\n          }\n        }\n      }\n    }`\n\nexport type AllowanceId = string\n\nexport interface Allowance {\n    id: AllowanceId\n    tokenContractId: AddressId\n    ownerId: AddressId\n    spenderId: AddressId\n    editTransactionId?: TransactionId\n}\n\nexport interface AllowanceValue {\n    allowanceId: AllowanceId\n    value: BN\n    state: QueryStates\n}\n\nexport enum QueryStates {\n    QUERY_STATE_INITIAL,\n    QUERY_STATE_RUNNING,\n    QUERY_STATE_ERROR,\n    QUERY_STATE_COMPLETE,\n}\n\nexport interface QueryState {\n    state: QueryStates\n    currentPage: number\n    error?: string\n}\n\ninterface AllowancesState {\n    allowancesById: Record<AllowanceId, Allowance>\n    allowanceValuesById: Record<AllowanceId, AllowanceValue>\n    allowanceIdsByOwnerId: Record<AddressId, AllowanceId[]>\n    allowanceQueryStateByOwner: Record<AddressId, QueryState>\n}\n\ninterface AllowancePayload {\n    id: AllowanceId\n    allowance: Allowance\n}\n\ninterface QueryStatePayload {\n    ownerId: AddressId\n    queryState: QueryState\n}\n\n// initial state\nconst initialState: AllowancesState = {\n    allowancesById: {},\n    allowanceValuesById: {},\n    allowanceIdsByOwnerId: {},\n    allowanceQueryStateByOwner: {},\n}\n\nconst defaultQueryStateByOwner: QueryState = {\n    currentPage: 0,\n    state: QueryStates.QUERY_STATE_INITIAL,\n}\n\nexport const buildAllowanceId = (\n    tokenContractId: AddressId,\n    ownerId: AddressId,\n    spenderId: AddressId\n) => {\n    return `${ownerId}-${tokenContractId}-${spenderId}`\n}\n\nconst allowancesSlice = createSlice({\n    name: 'Allowances',\n    initialState: initialState,\n    reducers: {\n        addAllowance: {\n            reducer(state, action: PayloadAction<AllowancePayload>) {\n                const { id, allowance } = action.payload\n                if (Object.keys(state.allowancesById).includes(id)) {\n                    // already known.\n                    return\n                }\n                state.allowancesById[id] = allowance\n                state.allowanceIdsByOwnerId[allowance.ownerId].push(\n                    allowance.id\n                )\n                state.allowanceValuesById[id] = {\n                    allowanceId: id,\n                    state: QueryStates.QUERY_STATE_INITIAL,\n                    value: new BN('-1'),\n                }\n            },\n            prepare(\n                tokenContractId: AddressId,\n                ownerId: AddressId,\n                spenderId: AddressId\n            ) {\n                const id = buildAllowanceId(tokenContractId, ownerId, spenderId)\n                return {\n                    payload: {\n                        id,\n                        allowance: {\n                            id,\n                            tokenContractId,\n                            ownerId,\n                            spenderId,\n                        },\n                    },\n                }\n            },\n        },\n        setQueryState(state, action: PayloadAction<QueryStatePayload>) {\n            const { ownerId, queryState } = action.payload\n            state.allowanceQueryStateByOwner[ownerId] = queryState\n        },\n        setAllowanceValue(state, action: PayloadAction<AllowanceValue>) {\n            const allowanceValue = action.payload\n            state.allowanceValuesById[\n                allowanceValue.allowanceId\n            ] = allowanceValue\n        },\n    },\n    extraReducers: {\n        [addAddress.type](state, action: PayloadAction<EthAddressPayload>) {\n            const { id: ownerId } = action.payload\n            if (Object.keys(state.allowanceIdsByOwnerId).includes(ownerId)) {\n                // owner already known.\n                return\n            }\n            state.allowanceIdsByOwnerId[ownerId] = []\n            state.allowanceQueryStateByOwner[ownerId] = defaultQueryStateByOwner\n        },\n        [addTransaction.type](\n            state,\n            action: PayloadAction<EditAllowanceTransaction>\n        ) {\n            const { allowanceId, transactionId } = action.payload\n            state.allowancesById[allowanceId].editTransactionId = transactionId\n        },\n    },\n})\n\nexport const {\n    addAllowance,\n    setQueryState,\n    setAllowanceValue,\n} = allowancesSlice.actions\n\nexport default allowancesSlice.reducer\n\nexport const fetchAllowanceValueThunk = (\n    allowanceId: AllowanceId\n): AppThunk => async (dispatch: AppDispatch, getState) => {\n    // indicate start of loading\n    dispatch(\n        setAllowanceValue({\n            allowanceId,\n            value: new BN('-1'),\n            state: QueryStates.QUERY_STATE_RUNNING,\n        })\n    )\n\n    const allowance = getState().allowances.allowancesById[allowanceId]\n    const owner = getState().addresses.addressesById[allowance.ownerId]\n    const spender = getState().addresses.addressesById[allowance.spenderId]\n    const tokenContract = getState().tokenContracts.contractsById[\n        allowance.tokenContractId\n    ]\n\n    try {\n        const value = await tokenContract.contractInstance.allowance(\n            owner.address,\n            spender.address\n        )\n        dispatch(\n            setAllowanceValue({\n                allowanceId,\n                value,\n                state: QueryStates.QUERY_STATE_COMPLETE,\n            })\n        )\n    } catch (error) {\n        console.log(\n            `Failed to get allowance from token ${tokenContract.addressId}`\n        )\n        dispatch(\n            setAllowanceValue({\n                allowanceId,\n                value: new BN('-1'),\n                state: QueryStates.QUERY_STATE_ERROR,\n            })\n        )\n    }\n}\n\nexport const fetchAllowancesThunk = (ownerId: AddressId): AppThunk => async (\n    dispatch,\n    getState\n) => {\n    const owner = getState().addresses.addressesById[ownerId]\n    const web3 = getState().onboard.web3\n    if (!web3) {\n        console.log(`Missing web3!`)\n        return\n    }\n\n    let currentPage = 0\n\n    // update query state to indicate start of loading\n    dispatch(\n        setQueryState({\n            ownerId,\n            queryState: {\n                state: QueryStates.QUERY_STATE_RUNNING,\n                currentPage,\n            },\n        })\n    )\n\n    // prepare ERC20 contract\n    const erc20Contract = contract(ERC20Data)\n    erc20Contract.setProvider(web3.currentProvider)\n\n    // query dfuse API\n    let cursor = ''\n    try {\n        // search page by page until no more results are found\n        let numPageResults = 0\n        const badContracts: Array<string> = []\n        const knownContracts: Array<string> = []\n        const knownSpenders: Array<string> = []\n\n        do {\n            console.log(\n                `Getting page ${currentPage}. Last page result: ${numPageResults}.`\n            )\n            const response = await client.graphql(searchTransactions, {\n                variables: {\n                    limit: '50',\n                    query: `topic.0:${topicHashApprove} topic.1:${owner.address}`,\n                    cursor: cursor,\n                },\n            })\n            // abort if any errors reported\n            if (response.errors) {\n                throw response.errors\n            }\n\n            // get actual results\n            const edges = response.data.searchTransactions.edges || []\n            for (let edgeIndex = 0; edgeIndex < edges.length; edgeIndex++) {\n                const { node } = edges[edgeIndex]\n                for (let index = 0; index < node.matchingLogs.length; index++) {\n                    const logEntry = node.matchingLogs[index]\n                    // skip bad contracts\n                    if (badContracts.includes(logEntry.address.toLowerCase())) {\n                        continue\n                    }\n\n                    // Apparently dfuse query results based on topic sometimes return wrong topics. Double-check that the\n                    // logEntry actually is of the expected topic.\n                    if (logEntry.topics[0] !== topicHashApprove) {\n                        console.log(\n                            `Skipping log event. Topic is wrong, expected ${topicHashApprove}, got ${logEntry.topics[0]}. Transaction: ${node.hash}`\n                        )\n                        continue\n                    }\n\n                    const tokenContractAddress = logEntry.address.toLowerCase()\n\n                    if (logEntry.data === '0x') {\n                        console.log(\n                            `Detected bad contract at ${logEntry.address}: LogEntry.data is missing. Transaction: ${node.hash}.`\n                        )\n                        badContracts.push(tokenContractAddress)\n                        continue\n                    }\n\n                    let decoded\n                    try {\n                        decoded = web3.eth.abi.decodeLog(\n                            eventABI,\n                            logEntry.data,\n                            logEntry.topics.slice(1)\n                        )\n                    } catch (e) {\n                        console.log(\n                            `Detected bad contract at ${logEntry.address}: Can not decode logEntry from transaction: ${node.hash}:`\n                        )\n                        console.log(logEntry)\n                        badContracts.push(tokenContractAddress)\n                        continue\n                    }\n\n                    // check if spender is an actual address. Some contracts emit logs with spender 0x0...\n                    if (!parseInt(decoded.spender)) {\n                        console.log(\n                            `Skipping log event: Invalid spender ${decoded.spender}, contract: ${logEntry.address}`\n                        )\n                        continue\n                    }\n                    // double-check owner is correct.\n                    if (\n                        decoded.owner.toLowerCase() !==\n                        owner.address.toLowerCase()\n                    ) {\n                        console.log(\n                            `Skipping log event due to owner mismatch. Expected ${owner.address}, got ${decoded.owner}. Transaction: ${node.hash}`\n                        )\n                        continue\n                    }\n\n                    // Add tokenContract\n                    if (!knownContracts.includes(tokenContractAddress)) {\n                        // Check if the contract really implements the required ERC20 methods.\n                        let contractInstance: ERC20Detailed.ERC20DetailedInstance\n                        try {\n                            contractInstance = await erc20Contract.at(\n                                tokenContractAddress\n                            )\n                        } catch (error) {\n                            console.log(\n                                `Error instantiating contract at ${tokenContractAddress}: ${error}`\n                            )\n                            badContracts.push(tokenContractAddress)\n                            continue\n                        }\n                        try {\n                            // these are the required calls\n                            await contractInstance.totalSupply()\n                            await contractInstance.balanceOf(\n                                tokenContractAddress\n                            )\n                            await contractInstance.allowance(\n                                tokenContractAddress,\n                                tokenContractAddress\n                            )\n                            // TODO: Check if approve() method is available!\n                        } catch (error) {\n                            console.log(\n                                `Contract at ${tokenContractAddress} is not ERC20. Ignoring.`\n                            )\n                            badContracts.push(tokenContractAddress)\n                            continue\n                        }\n                        knownContracts.push(tokenContractAddress)\n                        // console.log(`Adding tokenContract ${tokenContractAddress}`)\n                        dispatch(addContractThunk(contractInstance))\n                    }\n                    // Add spender address and create allowance entry\n                    const spenderAddress = decoded.spender.toLowerCase()\n                    if (!knownSpenders.includes(spenderAddress)) {\n                        knownSpenders.push(spenderAddress)\n                        // console.log(`Adding Spender ${spenderAddress} for ${tokenContractAddress}`)\n                        dispatch(addAddressThunk(spenderAddress))\n                        // look for spender contract name on Etherscan\n                        dispatch(fetchEtherscanNameThunk(spenderAddress))\n                        // Add allowance entry\n                        dispatch(\n                            addAllowance(\n                                tokenContractAddress,\n                                ownerId,\n                                spenderAddress\n                            )\n                        )\n                    }\n                }\n            }\n            numPageResults = edges.length\n            currentPage++\n            // get start cursor for next page\n            cursor = response.data.searchTransactions.pageInfo.endCursor\n            dispatch(\n                setQueryState({\n                    ownerId,\n                    queryState: {\n                        state: QueryStates.QUERY_STATE_RUNNING,\n                        currentPage,\n                    },\n                })\n            )\n        } while (numPageResults > 0)\n\n        dispatch(\n            setQueryState({\n                ownerId,\n                queryState: {\n                    state: QueryStates.QUERY_STATE_COMPLETE,\n                    currentPage,\n                },\n            })\n        )\n    } catch (errors) {\n        console.log(errors)\n        dispatch(\n            setQueryState({\n                ownerId,\n                queryState: {\n                    state: QueryStates.QUERY_STATE_ERROR,\n                    currentPage,\n                    error: JSON.stringify(errors),\n                },\n            })\n        )\n    }\n}\n","import { AllowanceId } from '../allowancesList/AllowancesListSlice'\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit'\n\nexport enum TransactionStates {\n    INITIAL,\n    SUBMITTED,\n    CONFIRMED,\n    FAILED,\n}\n\nexport type TransactionId = string\nexport interface EditAllowanceTransaction {\n    transactionId: TransactionId\n    allowanceId: AllowanceId\n    transactionState: TransactionStates\n    transactionHash?: string\n    error?: string\n}\n\ninterface TransactionTrackerState {\n    transactionsById: Record<TransactionId, EditAllowanceTransaction>\n}\n\ninterface UpdateTransactionPayload {\n    transactionId: TransactionId\n    transactionState?: TransactionStates\n    transactionHash?: string\n    error?: string\n}\n\nconst initialState: TransactionTrackerState = {\n    transactionsById: {},\n}\n\nconst TransactionTrackerSlice = createSlice({\n    name: 'transactionTracker',\n    initialState: initialState,\n    reducers: {\n        addTransaction(state, action: PayloadAction<EditAllowanceTransaction>) {\n            const editAllowanceTransaction = action.payload\n            state.transactionsById[\n                editAllowanceTransaction.transactionId\n            ] = editAllowanceTransaction\n        },\n        updateTransaction(\n            state,\n            action: PayloadAction<UpdateTransactionPayload>\n        ) {\n            const {\n                transactionId,\n                transactionState,\n                error,\n                transactionHash,\n            } = action.payload\n            transactionState &&\n                (state.transactionsById[\n                    transactionId\n                ].transactionState = transactionState)\n            error && (state.transactionsById[transactionId].error = error)\n            transactionHash &&\n                (state.transactionsById[\n                    transactionId\n                ].transactionHash = transactionHash)\n        },\n    },\n})\n\nexport const {\n    addTransaction,\n    updateTransaction,\n} = TransactionTrackerSlice.actions\nexport default TransactionTrackerSlice.reducer\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport namehash from 'eth-ens-namehash'\nimport { AppDispatch, AppThunk } from '../../app/store'\n\nexport enum ResolvingStates {\n    Initial,\n    Resolving,\n    Resolved,\n}\nexport type AddressId = string\n\n// the plain address data without internal info like ID or resolving state\nexport interface EthAddress {\n    address: string // the actual address\n    ensName?: string // ensName for this address\n    resolvingState: ResolvingStates\n    esContractName?: string\n}\n\nexport interface EthAddressPayload {\n    id: AddressId\n    ethAddress: EthAddress\n}\n\ninterface EtherscanContractNamePayload {\n    id: AddressId\n    esContractName: string\n}\n\ninterface ResolvingStatePayload {\n    id: AddressId\n    resolvingState: ResolvingStates\n}\n\ninterface ENSNamePayload {\n    id: AddressId\n    ensName: string\n}\n\n// The state contains all known EthAddressess, indexed by the address id\ninterface EthAddressesState {\n    addressesById: Record<AddressId, EthAddress>\n    checkAddressId: AddressId | undefined\n    walletAddressId: AddressId | undefined\n}\n\n// initial state: contains 3 test entries\nconst initialState: EthAddressesState = {\n    addressesById: {},\n    walletAddressId: undefined,\n    checkAddressId: undefined,\n}\n\nconst addressSlice = createSlice({\n    name: 'ethAddresses',\n    initialState: initialState,\n    reducers: {\n        addAddress: {\n            reducer(state, action: PayloadAction<EthAddressPayload>) {\n                const { id, ethAddress } = action.payload\n                state.addressesById[id] = ethAddress\n            },\n            prepare(address: string) {\n                return {\n                    payload: {\n                        id: address,\n                        ethAddress: {\n                            address: address,\n                            resolvingState: ResolvingStates.Initial,\n                        },\n                    },\n                }\n            },\n        },\n        setResolvingState(state, action: PayloadAction<ResolvingStatePayload>) {\n            const { id, resolvingState } = action.payload\n            state.addressesById[id].resolvingState = resolvingState\n        },\n        setENSName(state, action: PayloadAction<ENSNamePayload>) {\n            const { id, ensName } = action.payload\n            state.addressesById[id].ensName = ensName\n        },\n        setCheckAddressId(state, action: PayloadAction<AddressId>) {\n            state.checkAddressId = action.payload\n        },\n        clearCheckAddressId(state) {\n            state.checkAddressId = undefined\n        },\n        setWalletAddressId(state, action: PayloadAction<AddressId>) {\n            state.walletAddressId = action.payload\n        },\n        setEtherscanContractName(\n            state,\n            action: PayloadAction<EtherscanContractNamePayload>\n        ) {\n            const { id, esContractName } = action.payload\n            state.addressesById[id].esContractName = esContractName\n        },\n    },\n})\n\nexport const {\n    addAddress,\n    setResolvingState,\n    setENSName,\n    setCheckAddressId,\n    clearCheckAddressId,\n    setWalletAddressId,\n    setEtherscanContractName,\n} = addressSlice.actions\n\nexport default addressSlice.reducer\n\nexport const fetchEtherscanNameThunk = (\n    addressId: AddressId\n): AppThunk => async (dispatch: AppDispatch) => {\n    const apiKey = 'THS8KWYM6KZ8WBP3DXKUDR7UKCRB8YIRGH'\n    const requestUrl = `https://api.etherscan.io/api?module=contract&action=getsourcecode&address=${addressId}&apikey=${apiKey}`\n    const response = await fetch(requestUrl)\n    const data = await response.json()\n    if (data.message === 'OK') {\n        const contractName: string = data?.result[0]?.ContractName\n        if (contractName?.length) {\n            dispatch(\n                setEtherscanContractName({\n                    id: addressId,\n                    esContractName: contractName,\n                })\n            )\n        }\n    } else {\n        console.log(\n            `Got message ${data.message} fetching contract data from Etherscan API.`\n        )\n    }\n}\n\nexport const addAddressThunk = (address: string): AppThunk => async (\n    dispatch: AppDispatch,\n    getState\n) => {\n    address = address.toLowerCase()\n    // prevent duplicates\n    if (Object.keys(getState().addresses.addressesById).includes(address)) {\n        return\n    }\n    const web3 = getState().onboard.web3\n    if (web3) {\n        // first add address\n        dispatch(addAddress(address))\n\n        // indicate starting resolving process\n        dispatch(\n            setResolvingState({\n                id: address,\n                resolvingState: ResolvingStates.Resolving,\n            })\n        )\n\n        // look for reverse ENS name\n        try {\n            const reverseENSLookupName = address.substr(2) + '.addr.reverse'\n            const ResolverContract = await web3.eth.ens.resolver(\n                reverseENSLookupName\n            )\n            const reverseENS = await ResolverContract.methods\n                .name(namehash.hash(reverseENSLookupName))\n                .call()\n            console.log(`Got reverseENS: ${reverseENS}`)\n            dispatch(\n                setENSName({\n                    id: address,\n                    ensName: reverseENS,\n                })\n            )\n        } catch (error) {\n            // console.log(`Error getting reverse ENS: ${error}`)\n        }\n\n        dispatch(\n            setResolvingState({\n                id: address,\n                resolvingState: ResolvingStates.Resolved,\n            })\n        )\n    } else {\n        console.log(`AddressSlice: Can not add ${address} - web3 still missing`)\n    }\n}\n\nexport const setCheckAddressThunk = (checkAddress: string): AppThunk => async (\n    dispatch: AppDispatch\n) => {\n    if (checkAddress.endsWith('.eth')) {\n        // TODO: handle ENS names\n        console.log(`ENS name not yet handled: ${checkAddress}`)\n        return\n    }\n    dispatch(addAddressThunk(checkAddress))\n    dispatch(setCheckAddressId(checkAddress))\n}\n\nexport const setWalletAddressThunk = (\n    walletAddress: string\n): AppThunk => async (dispatch: AppDispatch) => {\n    console.log(`Got new address from wallet: ${walletAddress}`)\n    dispatch(addAddressThunk(walletAddress))\n    dispatch(setWalletAddressId(walletAddress))\n}\n","interface ContractMetadata {\n    name: string\n    symbol: string\n}\ninterface ContractInfo {\n    [key: string]: ContractMetadata\n}\n\nexport interface WellKnownContracts {\n    [key: number]: ContractInfo\n}\n\nexport const wellKnownContracts: WellKnownContracts = {\n    // main network\n    1: {\n        '0x89d24a6b4ccb1b6faa2625fe562bdd9a23260359': {\n            name: 'Sai Stablecoin',\n            symbol: 'SAI',\n        },\n        '0x9f8f72aa9304c8b593d555f12ef6589cc3a579a2': {\n            name: 'Maker Token',\n            symbol: 'MKR',\n        },\n        '0xecf8f87f810ecf450940c9f60066b4a7a501d6a7': {\n            name: 'Old Wrapped Ether',\n            symbol: 'WETH',\n        },\n        '0xc66ea802717bfb9833400264dd12c2bceaa34a6d': {\n            name: 'Old Maker Token',\n            symbol: 'MKR',\n        },\n        '0xbb9bc244d798123fde783fcc1c72d3bb8c189413': {\n            name: 'TheDAO Token',\n            symbol: 'TheDAO',\n        },\n        '0x86fa049857e0209aa7d9e616f7eb3b3b78ecfdb0': {\n            name: 'EOS: Old Token',\n            symbol: 'EOS',\n        },\n    },\n}\n\nexport default wellKnownContracts\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { v4 as uuidv4 } from 'uuid'\nimport { AppThunk } from '../../app/store'\nimport wellKnownContracts from '../../utils/wellKnownContracts'\nimport { ERC20DetailedInstance } from '../../contracts'\nimport ERC20Detailed from 'contracts'\nimport { AddressId, addAddressThunk } from 'features/addressInput/AddressSlice'\nimport {\n    AllowanceId,\n    fetchAllowanceValueThunk,\n} from '../allowancesList/AllowancesListSlice'\nimport {\n    addTransaction,\n    TransactionStates,\n    updateTransaction,\n} from 'features/transactionTracker/TransactionTrackerSlice'\nimport BN from 'bn.js'\n\ninterface TokenContract {\n    addressId: AddressId\n    name: string\n    symbol: string\n    decimals: BN\n    totalSupply: BN\n    contractInstance: ERC20DetailedInstance\n}\ninterface TokenContractPayload {\n    id: AddressId\n    tokenContract: TokenContract\n}\n\ninterface TokenContractsState {\n    contractsById: Record<AddressId, TokenContract>\n}\n\nconst initialState: TokenContractsState = {\n    contractsById: {},\n}\n\nconst tokenContractSlice = createSlice({\n    name: 'tokenContracts',\n    initialState: initialState,\n    reducers: {\n        addContract: {\n            reducer(state, action: PayloadAction<TokenContractPayload>) {\n                const { id, tokenContract } = action.payload\n                state.contractsById[id] = tokenContract\n            },\n            prepare(\n                contractAddress: AddressId,\n                tokenName: string,\n                tokenSymbol: string,\n                decimals: BN,\n                totalSupply: BN,\n                contractInstance: ERC20Detailed.ERC20DetailedInstance\n            ) {\n                return {\n                    payload: {\n                        id: contractAddress,\n                        tokenContract: {\n                            addressId: contractAddress,\n                            name: tokenName,\n                            symbol: tokenSymbol,\n                            decimals,\n                            totalSupply,\n                            contractInstance,\n                        },\n                    },\n                }\n            },\n        },\n    },\n})\n\nexport const { addContract } = tokenContractSlice.actions\n\nexport default tokenContractSlice.reducer\n\nexport const addContractThunk = (\n    contractInstance: ERC20Detailed.ERC20DetailedInstance\n): AppThunk => async (dispatch, getState) => {\n    const { networkId } = getState().onboard\n    const contractAddress = contractInstance.address.toLowerCase()\n    let tokenName = ''\n    let tokenSymbol = ''\n    // Some contracts like MKR and SAI do not implement the correct ERC20 name and symbol.\n    // Get their data from hardocded fallback\n    if (Object.keys(wellKnownContracts[networkId]).includes(contractAddress)) {\n        tokenName = wellKnownContracts[networkId][contractAddress].name\n        tokenSymbol = wellKnownContracts[networkId][contractAddress].symbol\n    } else {\n        try {\n            tokenName = await contractInstance.name()\n            tokenSymbol = await contractInstance.symbol()\n        } catch (error) {\n            // Most likely token contract does not implement the name() method. Ignore error.\n            console.log(`Failed to get name/symbol of contract at ${contractAddress}. Please raise\n                an issue to add this token at https://github.com/TripleSpeeder/token-allowance-checker/issues!`)\n        }\n    }\n    let decimals = new BN('0')\n    try {\n        decimals = await contractInstance.decimals()\n    } catch (error) {\n        console.log(\n            `Contract at ${contractAddress} does not provide decimals(). Assuming 0.`\n        )\n    }\n    let totalSupply\n    try {\n        totalSupply = await contractInstance.totalSupply()\n    } catch (error) {\n        console.log(\n            `Failed to call totalSupply() at ${contractAddress}. Ignoring contract.`\n        )\n        return\n    }\n    dispatch(addAddressThunk(contractAddress))\n    dispatch(\n        addContract(\n            contractAddress,\n            tokenName,\n            tokenSymbol,\n            decimals,\n            totalSupply,\n            contractInstance\n        )\n    )\n}\n\nexport const setAllowanceThunk = (\n    tokenContractId: AddressId,\n    spender: AddressId,\n    allowance: BN,\n    allowanceId: AllowanceId\n): AppThunk => async (dispatch, getState) => {\n    console.log(\n        `Setting new allowance ${allowance.toString()} for tokenContractId ${tokenContractId}`\n    )\n    const { contractInstance } = getState().tokenContracts.contractsById[\n        tokenContractId\n    ]\n    const { walletAddressId } = getState().addresses\n    const transactionId: string = uuidv4()\n    dispatch(\n        addTransaction({\n            transactionId,\n            allowanceId,\n            transactionState: TransactionStates.SUBMITTED,\n        })\n    )\n    try {\n        const result = await contractInstance.approve(\n            spender,\n            allowance.toString(),\n            {\n                from: walletAddressId,\n            }\n        )\n        console.log(`transaction confirmed: ${result.tx}. Reloading allowance.`)\n        dispatch(\n            updateTransaction({\n                transactionId,\n                transactionState: TransactionStates.CONFIRMED,\n                transactionHash: result.tx,\n            })\n        )\n        dispatch(fetchAllowanceValueThunk(allowanceId))\n    } catch (e) {\n        console.log(`Error while approving: ${e.message}`)\n        dispatch(\n            updateTransaction({\n                transactionId,\n                transactionState: TransactionStates.FAILED,\n                error: e.message,\n            })\n        )\n    }\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport Onboard from 'bnc-onboard'\nimport Web3 from 'web3'\nimport { AppDispatch, AppThunk } from '../../app/store'\nimport { API, WalletInitOptions } from 'bnc-onboard/dist/src/interfaces'\nimport { AddressId, setWalletAddressThunk } from '../addressInput/AddressSlice'\n\nconst onboardApiKey = 'f4b71bf0-fe50-4eeb-bc2b-b323527ed9e6'\nconst infuraApiKey = '7f230a5ca832426796454c28577d93f2'\n\nconst wallets: Partial<WalletInitOptions>[] = [\n    { walletName: 'metamask', preferred: true },\n    { walletName: 'coinbase', preferred: true },\n    {\n        walletName: 'walletConnect',\n        infuraKey: infuraApiKey,\n        preferred: true,\n    },\n    { walletName: 'trust', preferred: true },\n    { walletName: 'dapper', preferred: true },\n    { walletName: 'authereum', preferred: true },\n    { walletName: 'opera' },\n    { walletName: 'status' },\n    { walletName: 'operaTouch' },\n    { walletName: 'torus' },\n    { walletName: 'status' },\n    {\n        walletName: 'ledger',\n        rpcUrl: `mainnet.infura.io/v3/${infuraApiKey}`,\n    },\n    {\n        walletName: 'trezor',\n        appUrl: 'https://tac.dappstar.io',\n        email: 'michael@m-bauer.org',\n        rpcUrl: `mainnet.infura.io/v3/${infuraApiKey}`,\n    },\n]\n\n// Define contents of onboard state\ninterface OnboardState {\n    onboardAPI: API | null\n    web3?: Web3\n    networkId: number\n    walletSelected: boolean\n    prevWalletAddressId: AddressId | undefined\n}\n\nconst initialState: OnboardState = {\n    networkId: 0,\n    onboardAPI: null,\n    walletSelected: false,\n    prevWalletAddressId: undefined,\n}\n\nconst onboardSlice = createSlice({\n    name: 'onboard',\n    initialState: initialState,\n    reducers: {\n        setOnboardAPI(state, action: PayloadAction<API>) {\n            state.onboardAPI = action.payload\n        },\n        setWeb3Instance(state, action: PayloadAction<Web3>) {\n            state.web3 = action.payload\n        },\n        setNetworkId(state, action: PayloadAction<number>) {\n            state.networkId = action.payload\n        },\n        setPrevWalletAddressId(state, action: PayloadAction<string>) {\n            state.prevWalletAddressId = action.payload\n        },\n        setWalletSelected(state, action: PayloadAction<boolean>) {\n            state.walletSelected = action.payload\n        },\n    },\n})\n\nexport const {\n    setOnboardAPI,\n    setNetworkId,\n    setWeb3Instance,\n    setWalletSelected,\n    setPrevWalletAddressId,\n} = onboardSlice.actions\n\nexport default onboardSlice.reducer\n\nexport const checkWallet = (): AppThunk => async (dispatch, getState) => {\n    console.log(`checking wallet...`)\n    const onboardAPI = getState().onboard.onboardAPI\n    if (onboardAPI) {\n        const result = await onboardAPI.walletCheck()\n        console.log(`walletCheck result: ${result}`)\n    } else {\n        console.log(`dispatched checkWallet() without initialization...`)\n    }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const selectWallet = (history: any): AppThunk => async (\n    dispatch,\n    getState\n) => {\n    console.log(`Selecting wallet...`)\n    const onboardAPI = getState().onboard.onboardAPI\n    if (onboardAPI) {\n        const result = await onboardAPI.walletSelect()\n        dispatch(setWalletSelected(result))\n        if (!result) {\n            // send user back to home page\n            history.push('/')\n        } else {\n            // to get access to account\n            dispatch(checkWallet())\n        }\n    } else {\n        console.log(`dispatched selectWallet() without initialization...`)\n    }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const initialize = (history: any): AppThunk => async (\n    dispatch: AppDispatch,\n    getState\n) => {\n    console.log(`Initializing OnBoard.js...`)\n    const onboard = Onboard({\n        dappId: onboardApiKey,\n        networkId: 1,\n        subscriptions: {\n            wallet: wallet => {\n                dispatch(setWeb3Instance(new Web3(wallet.provider)))\n            },\n            address: address => {\n                console.log(`Wallet address changed to ${address}!`)\n                dispatch(setWalletAddressThunk(address))\n                const { prevWalletAddressId } = getState().onboard\n                //  Only trigger history push when user changed the wallet address\n                if (\n                    prevWalletAddressId &&\n                    prevWalletAddressId !== address.toLowerCase()\n                ) {\n                    console.log(\n                        `Pushing ${address}. Prev walletId: ${prevWalletAddressId}`\n                    )\n                    history.push(`/address/${address}`)\n                }\n                dispatch(setPrevWalletAddressId(address.toLowerCase()))\n            },\n            network: networkId => {\n                dispatch(setNetworkId(networkId))\n            },\n            balance: () => {\n                /* do nothing*/\n            },\n        },\n        walletSelect: {\n            heading: 'Select walletName',\n            description: 'Select walletName description',\n            // eslint-disable-next-line @typescript-eslint/ban-ts-ignore\n            // @ts-ignore\n            wallets: wallets,\n        },\n    })\n    dispatch(setOnboardAPI(onboard))\n}\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 832;","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { AddressId } from 'features/addressInput/AddressSlice'\nimport { QueryStates } from '../allowancesList/AllowancesListSlice'\nimport BN from 'bn.js'\nimport { AppDispatch, AppThunk } from '../../app/store'\n\nexport type BalanceId = string\n\ninterface Balance {\n    id: BalanceId\n    addressId: AddressId\n    tokenContractId: AddressId\n    queryState: QueryStates\n    value: BN\n}\n\ninterface BalancePayload {\n    id: BalanceId\n    balance: Balance\n}\n\ninterface ValuePayload {\n    id: BalanceId\n    value: BN\n}\n\ninterface QueryStatePayload {\n    id: BalanceId\n    queryState: QueryStates\n}\n\ninterface BalancesState {\n    balancesById: Record<BalanceId, Balance>\n}\n\nconst initialState: BalancesState = {\n    balancesById: {},\n}\n\nconst balancesSlice = createSlice({\n    name: 'balances',\n    initialState: initialState,\n    reducers: {\n        addBalance: {\n            reducer(state, action: PayloadAction<BalancePayload>) {\n                const { id, balance } = action.payload\n                state.balancesById[id] = balance\n            },\n            prepare(\n                id: BalanceId,\n                addressId: AddressId,\n                tokenContractId: AddressId\n            ) {\n                return {\n                    payload: {\n                        id: id,\n                        balance: {\n                            id,\n                            addressId,\n                            tokenContractId,\n                            queryState: QueryStates.QUERY_STATE_INITIAL,\n                            value: new BN('-1'),\n                        },\n                    },\n                }\n            },\n        },\n        setBalanceValue(state, action: PayloadAction<ValuePayload>) {\n            const { id, value } = action.payload\n            state.balancesById[id].value = value\n        },\n        setBalanceQuerystate(state, action: PayloadAction<QueryStatePayload>) {\n            const { id, queryState } = action.payload\n            state.balancesById[id].queryState = queryState\n        },\n    },\n})\n\nexport const buildBalanceId = (\n    addressId: AddressId,\n    tokenContractId: AddressId\n) => {\n    return `${addressId}-${tokenContractId}`\n}\n\nexport const {\n    addBalance,\n    setBalanceValue,\n    setBalanceQuerystate,\n} = balancesSlice.actions\n\n/*\n Create a new balance entry and fetch balance\n */\nexport const addBalanceThunk = (\n    addressId: AddressId,\n    tokenContractId: AddressId\n): AppThunk => async (dispatch: AppDispatch, getState) => {\n    const balanceId = buildBalanceId(addressId, tokenContractId)\n    dispatch(addBalance(balanceId, addressId, tokenContractId))\n    dispatch(\n        setBalanceQuerystate({\n            id: balanceId,\n            queryState: QueryStates.QUERY_STATE_RUNNING,\n        })\n    )\n    const tokenContract = getState().tokenContracts.contractsById[\n        tokenContractId\n    ]\n    const address = getState().addresses.addressesById[addressId]\n    try {\n        const balance = await tokenContract.contractInstance.balanceOf(\n            address.address\n        )\n        dispatch(\n            setBalanceValue({\n                id: balanceId,\n                value: balance,\n            })\n        )\n        dispatch(\n            setBalanceQuerystate({\n                id: balanceId,\n                queryState: QueryStates.QUERY_STATE_COMPLETE,\n            })\n        )\n    } catch (error) {\n        console.log(`Error getting balance: ${error}`)\n        dispatch(\n            setBalanceQuerystate({\n                id: balanceId,\n                queryState: QueryStates.QUERY_STATE_ERROR,\n            })\n        )\n    }\n}\nexport default balancesSlice.reducer\n"],"sourceRoot":""}