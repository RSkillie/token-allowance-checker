(this.webpackJsonpTAC=this.webpackJsonpTAC||[]).push([[1],{1004:function(e,t){},1028:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(91),l=a.n(c),o=(a(501),a(502),a(71)),s=a(75),i=a(8),u=a.n(i),d=a(31),m=a(17),p=a(476),b=a(452),f=a(261),g=a.n(f),h=a(1073),w=a(1069),E=a(61),v="7f230a5ca832426796454c28577d93f2",k=Object(n.createContext)({onboard:null,web3:null,address:null,networkId:null,loggedIn:!1,loginFunction:null}),y=[{walletName:"metamask",preferred:!0},{walletName:"coinbase",preferred:!0},{walletName:"walletConnect",infuraKey:v,preferred:!0},{walletName:"trust",preferred:!0},{walletName:"dapper",preferred:!0},{walletName:"authereum",preferred:!0},{walletName:"opera"},{walletName:"status"},{walletName:"operaTouch"},{walletName:"torus"},{walletName:"status"},{walletName:"ledger",rpcUrl:"mainnet.infura.io/v3/".concat(v)},{walletName:"trezor",appUrl:"https://tac.dappstar.io",email:"michael@m-bauer.org",rpcUrl:"mainnet.infura.io/v3/".concat(v)}],O=function(e){var t=Object(n.useState)(),a=Object(m.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(),s=Object(m.a)(o,2),i=s[0],p=s[1],f=Object(n.useState)(),v=Object(m.a)(f,2),O=v[0],S=v[1],x=Object(n.useState)(),j=Object(m.a)(x,2),C=j[0],A=j[1],T=Object(n.useState)(!1),z=Object(m.a)(T,2),N=z[0],I=z[1],F=Object(n.useState)(!1),D=Object(m.a)(F,2),L=D[0],H=D[1];Object(n.useEffect)((function(){console.log("Initializing OnBoard.js...");var e=Object(b.a)({dappId:"f4b71bf0-fe50-4eeb-bc2b-b323527ed9e6",networkId:1,subscriptions:{wallet:function(e){console.log("".concat(e.name," is now connected!")),l(new g.a(e.provider))},address:function(e){p(e),console.log("Address changed to ".concat(e,"!"))},network:function(e){S(e),console.log("NetworkId change to ".concat(e))}},walletSelect:{wallets:y}});A(e)}),[]);var B=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=15;break}if(L){e.next=11;break}return console.log("Selecting wallet..."),e.next=5,C.walletSelect();case 5:return t=e.sent,console.log("... Got wallet!"),H(t),e.abrupt("return",t);case 11:return console.log("Wallet already selected."),e.abrupt("return",!0);case 13:e.next=17;break;case 15:return console.log("Trying select wallet without onboard"),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=22;break}if(L){e.next=8;break}return e.next=4,B();case 4:if(e.sent){e.next=8;break}return console.log("Selecting wallet failed in login"),e.abrupt("return",!1);case 8:if(N){e.next=18;break}return console.log("performing walletCheck()..."),e.next=12,C.walletCheck();case 12:return t=e.sent,console.log("... Done! Result: ".concat(t)),I(t),e.abrupt("return",t);case 18:return console.log("already logged in"),e.abrupt("return",!0);case 20:e.next=24;break;case 22:return console.log("Trying login without onboard"),e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_={onboard:C,web3:c,address:i,networkId:O,loginFunction:R,selectFunction:B};return C?r.a.createElement(k.Provider,{value:_},e.children):(console.log("Onboard not yet initialized!"),r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(w.a,{info:!0,icon:!0,size:"huge"},r.a.createElement(E.a,{name:"spinner",loading:!0}),r.a.createElement(w.a.Content,null,r.a.createElement(w.a.Header,null,"Initializing web3"),"Please wait while initializing web3 connection.")))))},S=(a(780),a(455)),x=a(143),j=a.n(x);function C(e,t,a){if(!("string"===typeof(n=e)||n instanceof String))throw new Error("Pass strings to prevent floating point precision issues.");var n,r=new a(10).pow(new a(t)),c="-"===e.substring(0,1);if(c&&(e=e.substring(1)),"."===e)throw new Error("Invalid value ".concat(e," cannot be converted to")+" base unit with ".concat(t," decimals."));var l=e.split(".");if(l.length>2)throw new Error("Too many decimal points");var o=l[0],s=l[1];if(o||(o="0"),s||(s="0"),s.length>t)throw new Error("Too many decimal places");for(;s.length<t;)s+="0";o=new a(o),s=new a(s);var i=o.mul(r).add(s);return c&&(i=i.neg()),new a(i.toString(10),10)}var A=a(1065),T=a(1072),z=a(1064),N=a(1060),I=a(1071),F=function(e){var t=e.showModal,a=e.tokenName,n=e.tokenAddress,c=e.spenderAddress,l=e.currentAllowance,o=e.newAllowance,s=e.handleClose,i=e.handleSubmit,u=e.handleChange,d=a;return""===d&&(d="Unnamed ERC20 at ".concat(n)),r.a.createElement(A.a,{open:t,size:"small",onClose:s},r.a.createElement(T.a,null,"Edit Allowance"),r.a.createElement(A.a.Content,null,r.a.createElement(w.a,{size:"huge"},r.a.createElement(w.a.List,null,r.a.createElement(w.a.Item,null,"Token: ",d),r.a.createElement(w.a.Item,null,"Spender: ",c),r.a.createElement(w.a.Item,null,"Current allowance: ",l))),r.a.createElement(z.a,{size:"huge",onSubmit:i},r.a.createElement(z.a.Field,{required:!0},r.a.createElement(N.a,{label:{tag:!0,content:"Set new allowance"},labelPosition:"right",placeholder:"Enter amount",type:"number",name:"newAllowance",onChange:u,value:o})),r.a.createElement(I.a,{columns:2},r.a.createElement(I.a.Row,null,r.a.createElement(I.a.Column,null,r.a.createElement(z.a.Button,{type:"button",fluid:!0,size:"huge",negative:!0,onClick:s},"Cancel")),r.a.createElement(I.a.Column,null,r.a.createElement(z.a.Button,{type:"submit",fluid:!0,size:"huge",positive:!0},"Okay")))))))},D=function(e){var t=e.handleSubmit,a=e.handleClose,c=e.tokenDecimals,l=e.tokenSupply,o=e.tokenName,s=e.allowance,i=e.spender,u=e.tokenSymbol,d=e.tokenAddress,p=Object(n.useContext)(k),b=Object(n.useState)("0"),f=Object(m.a)(b,2),g=f[0],h=f[1],w=Object(n.useCallback)((function(){return s.gte(l)?"unlimited":j()({value:s,decimals:c,roundToDecimals:p.web3.utils.toBN(2)}).rounded}),[s,c,l,p]);return r.a.createElement(F,{currentAllowance:w(),handleClose:a,spenderAddress:i,showModal:!0,tokenName:o,handleChange:function(e,t){var a=t.name,n=t.value;console.log("handleChange: ".concat(a," - ").concat(n)),parseFloat(n)<0&&(n="0"),h(n)},handleSubmit:function(){var e=C(g,c,p.web3.utils.BN);t(e)},tokenSymbol:u,tokenAddress:d,newAllowance:g})},L=a(1029),H=function(e){var t,a=e.showModal,n=e.isConfirming,c=e.transactionHash,l=e.error,o=e.handleClose;return l?t=r.a.createElement(w.a,{error:!0,icon:!0},r.a.createElement(E.a,{name:"exclamation triangle"}),r.a.createElement(w.a.Content,null,r.a.createElement(w.a.Header,null,"Error"),l)):c?t=r.a.createElement(w.a,{success:!0,icon:!0},r.a.createElement(E.a,{name:"checkmark"}),r.a.createElement(w.a.Content,null,r.a.createElement(w.a.Header,null,"Allowance changed"),r.a.createElement("p",null,"The new allowance is now set."),r.a.createElement("p",null,"Transaction Hash: ",c))):n&&(t=r.a.createElement(w.a,{icon:!0,info:!0},r.a.createElement(E.a,{name:"spinner",loading:!0}),r.a.createElement(w.a.Content,null,r.a.createElement(w.a.Header,null,"Waiting for confirmation"),"Transaction is being processed..."))),r.a.createElement(A.a,{open:a,size:"small",onClose:o},r.a.createElement(A.a.Content,null,t),!n&&r.a.createElement(A.a.Actions,null,r.a.createElement(L.a,{onClick:o},"Dismiss")))},B=a(1061),R=a(1066),_=a(1068),M=function(e){var t=e.address,a=e.ensName,n=function(){navigator.clipboard.writeText(t).then((function(){}),(function(){console.log("failed to set clipboard")}))};return a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,a),r.a.createElement("div",null,r.a.createElement("small",null,t,"\xa0",r.a.createElement(R.a,{mouseEnterDelay:500,content:"Copy to clipboard",trigger:r.a.createElement(E.a,{circular:!0,name:"copy outline",size:"small",onClick:function(){n()}})}),r.a.createElement(R.a,{mouseEnterDelay:500,content:"View on Etherscan",trigger:r.a.createElement(E.a,{circular:!0,name:"external square",size:"small",onClick:function(){window.open("https://etherscan.io/address/".concat(t),"_blank")}})})))):r.a.createElement("div",null,t,"\xa0",r.a.createElement(R.a,{mouseEnterDelay:500,content:"Copy to clipboard",trigger:r.a.createElement(E.a,{circular:!0,name:"copy outline",size:"small",onClick:function(){n()}})}),r.a.createElement(R.a,{mouseEnterDelay:500,content:"View on Etherscan",trigger:r.a.createElement(E.a,{circular:!0,name:"external square",size:"small",onClick:function(){window.open("https://etherscan.io/address/".concat(t),"_blank")}})}))},q=a(51),P=a.n(q),Z=new P.a(2).pow(new P.a(256)).subn(1),U=function(e){var t=e.tokenName,a=e.tokenAddress,n=e.tokenDecimals,c=e.tokenSupply,l=(e.tokenSymbol,e.ownerBalance),o=e.spenders,s=e.spenderENSNames,i=e.allowances,u=e.showZeroAllowances,d=e.editEnabled,m=e.openEditModal,p=[],b=!0,f=!1,g=void 0;try{for(var w,E=function(){var e=w.value,t=void 0,l=!1,o=void 0,b=P.a.isBN(i[e])&&P.a.isBN(n)&&P.a.isBN(c);if(b)if(l=(o=i[e]).eq(Z)||o.gte(c))t=r.a.createElement("em",null,"unlimited");else{var f=n,g=new P.a(2),h=j()({value:o,decimals:f,roundToDecimals:g}).rounded;t="".concat(h)}else t=r.a.createElement(B.a,{active:!0,inline:!0,size:"mini"});var E=void 0;E=b?r.a.createElement(R.a,{content:d?"edit allowance":"Only address owner can edit allowance",trigger:r.a.createElement("span",null,r.a.createElement(L.a,{icon:"edit",size:"small",compact:!0,primary:!0,disabled:!d,onClick:function(){m(e)}}))}):r.a.createElement(B.a,{active:!0,inline:!0,size:"mini"}),o&&o.isZero()&&!u||p.push(r.a.createElement(_.a.Row,{key:"".concat(a,"-").concat(e)},r.a.createElement(_.a.Cell,null,r.a.createElement(M,{address:e,ensName:s[e]})),r.a.createElement(_.a.Cell,{negative:l},t),r.a.createElement(_.a.Cell,null,E)))},v=o[Symbol.iterator]();!(b=(w=v.next()).done);b=!0)E()}catch(x){f=!0,g=x}finally{try{b||null==v.return||v.return()}finally{if(f)throw g}}if(0===p.length)return null;var k=t;""===k&&(k="Unnamed ERC20");var y=new P.a(2);if(P.a.isBN(l)&&P.a.isBN(n)){var O=j()({value:l,decimals:n,roundToDecimals:y}).rounded;k+=" (current balance: ".concat(O,")")}var S=r.a.createElement(M,{address:a,ensName:k});return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{raised:!0},r.a.createElement(T.a,{as:"h3"},S),r.a.createElement(_.a,{basic:"very",celled:!0,selectable:!0},r.a.createElement(_.a.Header,null,r.a.createElement(_.a.Row,null,r.a.createElement(_.a.HeaderCell,null,"Spender"),r.a.createElement(_.a.HeaderCell,null,"Allowance"),r.a.createElement(_.a.HeaderCell,null,"Action"))),r.a.createElement(_.a.Body,null,p))))},$=function(e){var t=e.tokenName,a=e.tokenAddress,c=e.tokenDecimals,l=e.tokenSupply,o=e.tokenSymbol,s=e.tokenContractInstance,i=e.ownerBalance,p=e.owner,b=e.spenders,f=e.spenderENSNames,g=e.allowances,h=e.showZeroAllowances,w=e.reloadAllowanceFunc,E=Object(n.useContext)(k),v=Object(n.useState)(""),y=Object(m.a)(v,2),O=y[0],S=y[1],x=Object(n.useState)(!1),j=Object(m.a)(x,2),C=j[0],A=j[1],T=Object(n.useState)(!1),z=Object(m.a)(T,2),N=z[0],I=z[1],F=Object(n.useState)(""),L=Object(m.a)(F,2),B=L[0],R=L[1],_=Object(n.useState)(""),M=Object(m.a)(_,2),q=M[0],P=M[1],Z=Object(n.useState)(!1),$=Object(m.a)(Z,2),G=$[0],K=$[1],W=function(){var e=Object(d.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.loginFunction();case 2:if(e.sent){e.next=8;break}return console.log("User failed to login. Cant create transaction."),e.abrupt("return");case 8:console.log("User successfully logged into wallet");case 9:return console.log("Setting new allowance ".concat(t," for ").concat(O)),R(""),P(""),A(!1),I(!0),K(!0),e.prev=15,e.next=18,s.approve(O,t.toString(),{from:E.address});case 18:a=e.sent,P(a.tx),w(p,O),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(15),console.log("Error while approving: ".concat(e.t0.message)),R(e.t0.message);case 27:K(!1);case 28:case"end":return e.stop()}}),e,null,[[15,23]])})));return function(t){return e.apply(this,arguments)}}(),J=p.toLowerCase()===E.address.toLowerCase();return r.a.createElement(r.a.Fragment,null,r.a.createElement(U,{allowances:g,tokenDecimals:c,tokenSupply:l,tokenAddress:a,tokenName:t,editEnabled:J,spenders:b,spenderENSNames:f,showZeroAllowances:h,openEditModal:function(e){S(e),A(!0)},ownerBalance:i}),C&&r.a.createElement(D,{spender:O,tokenDecimals:c,allowance:g[O],tokenSymbol:o,tokenName:t,tokenSupply:l,tokenAddress:a,handleSubmit:W,handleClose:function(){A(!1)}}),N&&r.a.createElement(H,{showModal:N,isConfirming:G,handleClose:function(){I(!1)},error:B,transactionHash:q}))},G={1:{"0x89d24a6b4ccb1b6faa2625fe562bdd9a23260359":{name:"Sai Stablecoin",symbol:"SAI"},"0x9f8f72aa9304c8b593d555f12ef6589cc3a579a2":{name:"Maker Token",symbol:"MKR"},"0xecf8f87f810ecf450940c9f60066b4a7a501d6a7":{name:"Old Wrapped Ether",symbol:"WETH"},"0xc66ea802717bfb9833400264dd12c2bceaa34a6d":{name:"Old Maker Token",symbol:"MKR"},"0xbb9bc244d798123fde783fcc1c72d3bb8c189413":{name:"TheDAO Token",symbol:"TheDAO"}}},K=a(885),W=a(83),J=function(e){var t=e.contractAddress,a=e.owner,c=e.spenders,l=e.showZeroAllowances,o=e.addressFilter,s=Object(n.useContext)(k),i=Object(n.useState)(null),p=Object(m.a)(i,2),b=p[0],f=p[1],g=Object(n.useState)(),h=Object(m.a)(g,2),w=h[0],E=h[1],v=Object(n.useState)(),y=Object(m.a)(v,2),O=y[0],x=y[1],j=Object(n.useState)(""),C=Object(m.a)(j,2),A=C[0],T=C[1],z=Object(n.useState)(""),N=Object(m.a)(z,2),I=N[0],F=N[1],D=Object(n.useState)({}),L=Object(m.a)(D,2),H=L[0],B=L[1],R=Object(n.useState)(!0),_=Object(m.a)(R,2)[1],M=Object(n.useState)({}),q=Object(m.a)(M,2),P=q[0],Z=q[1],U=Object(n.useState)(),J=Object(m.a)(U,2),V=J[0],Y=J[1],Q=Object(n.useState)(!0),X=Object(m.a)(Q,2),ee=X[0],te=X[1];Object(n.useEffect)((function(){var e=!1;return function(){var n=Object(d.a)(u.a.mark((function n(){var r,l,o,i,d,m,p,b,g,h,w,v,k,y,O,j;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return _(!0),r=!0,(l=K(S)).setProvider(s.web3.currentProvider),n.next=6,l.at(t);case 6:if(o=n.sent,i="",d="",!Object.keys(G[s.networkId]).includes(t.toLowerCase())){n.next=14;break}i=G[s.networkId][t.toLowerCase()].name,d=G[s.networkId][t.toLowerCase()].symbol,n.next=26;break;case 14:return n.prev=14,n.next=17,o.name();case 17:return i=n.sent,n.next=20,o.symbol();case 20:d=n.sent,n.next=26;break;case 23:n.prev=23,n.t0=n.catch(14),console.warn("Failed to get name/symbol of contract at ".concat(t,". Please raise\n                    an issue to add this token at https://github.com/TripleSpeeder/token-allowance-checker/issues!"));case 26:return m=s.web3.utils.toBN("0"),n.prev=27,n.next=30,o.decimals();case 30:m=n.sent,n.next=36;break;case 33:n.prev=33,n.t1=n.catch(27),console.warn("Contract at ".concat(t," does not provide decimals(). Assuming 0."));case 36:return n.prev=36,n.next=39,o.totalSupply();case 39:return p=n.sent,n.next=42,o.balanceOf(a);case 42:b=n.sent,n.next=49;break;case 45:n.prev=45,n.t2=n.catch(36),console.warn("Contract at ".concat(t," is not ERC20. Ignoring.")),r=!1;case 49:if(!e){n.next=51;break}return n.abrupt("return");case 51:if(te(r),f(o),E(m),x(p),Y(b),T(i),F(d),g={},!r){n.next=100;break}h=!0,w=!1,v=void 0,n.prev=63,k=c[Symbol.iterator]();case 65:if(h=(y=k.next()).done){n.next=85;break}return O=y.value,n.prev=67,n.next=70,o.allowance(a,O);case 70:if(j=n.sent,!e){n.next=73;break}return n.abrupt("return");case 73:g[O]=j,n.next=82;break;case 76:return n.prev=76,n.t3=n.catch(67),console.warn("Contract at ".concat(t," not ERC20 compliant. Failed to get allowance.")),r=!1,te(!1),n.abrupt("break",85);case 82:h=!0,n.next=65;break;case 85:n.next=91;break;case 87:n.prev=87,n.t4=n.catch(63),w=!0,v=n.t4;case 91:n.prev=91,n.prev=92,h||null==k.return||k.return();case 94:if(n.prev=94,!w){n.next=97;break}throw v;case 97:return n.finish(94);case 98:return n.finish(91);case 99:r&&B(g);case 100:_(!1);case 101:case"end":return n.stop()}}),n,null,[[14,23],[27,33],[36,45],[63,87,91,99],[67,76],[92,,94,98]])})));return function(){return n.apply(this,arguments)}}()(),function(){e=!0}}),[s.web3,s.networkId,t,a,c]),Object(n.useEffect)((function(){var e=!1,t=function(){var t=Object(d.a)(u.a.mark((function t(a){var n,r,l,o,s,i,d,m,p,b,f;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n={},r=!0,l=!1,o=void 0,t.prev=4,s=c[Symbol.iterator]();case 6:if(r=(i=s.next()).done){t.next=25;break}return d=i.value,t.prev=8,m=d.toLowerCase().substr(2)+".addr.reverse",t.next=12,a.eth.ens.resolver(m);case 12:return p=t.sent,b=W.hash(m),t.next=16,p.methods.name(b).call();case 16:f=t.sent,n[d]=f,t.next=22;break;case 20:t.prev=20,t.t0=t.catch(8);case 22:r=!0,t.next=6;break;case 25:t.next=31;break;case 27:t.prev=27,t.t1=t.catch(4),l=!0,o=t.t1;case 31:t.prev=31,t.prev=32,r||null==s.return||s.return();case 34:if(t.prev=34,!l){t.next=37;break}throw o;case 37:return t.finish(34);case 38:return t.finish(31);case 39:if(!e){t.next=41;break}return t.abrupt("return");case 41:Z(n);case 42:case"end":return t.stop()}}),t,null,[[4,27,31,39],[8,20],[32,,34,38]])})));return function(e){return t.apply(this,arguments)}}();return s.web3&&t(s.web3),function(){e=!0}}),[s.web3,c]);var ae=function(){var e=Object(d.a)(u.a.mark((function e(t,a){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,H[a]=void 0,B(H),e.next=5,b.allowance(t,a);case 5:n=e.sent,H[a]=n,B(H),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Error loading allowance: ".concat(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a){return e.apply(this,arguments)}}(),ne=!0;if(o.length){var re=o.toLowerCase();ne=A.toLowerCase().includes(re)||I.toLowerCase().includes(re)||t.toLowerCase().includes(re)}return ee&&ne?r.a.createElement($,{tokenName:A,tokenAddress:t,tokenDecimals:w,tokenSupply:O,tokenSymbol:I,owner:a,ownerBalance:V,spenders:c,spenderENSNames:P,allowances:H,tokenContractInstance:b,showZeroAllowances:l,addressFilter:o,reloadAllowanceFunc:ae}):null},V=function(e){for(var t=e.tokenSpenders,a=e.address,n=e.showZeroAllowances,c=e.addressFilter,l=e.loading,o=e.error,s=e.page,i=[],u=0,d=Object.entries(t);u<d.length;u++){var p=Object(m.a)(d[u],2),b=p[0],f=p[1];i.push(r.a.createElement(J,{key:b,owner:a,spenders:f,contractAddress:b,showZeroAllowances:n,addressFilter:c}))}return l?r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(w.a,{icon:!0,warning:!0,size:"huge"},r.a.createElement(E.a,{name:"circle notched",loading:!0}),r.a.createElement(w.a.Content,null,r.a.createElement(w.a.Header,null,"Please wait while loading events"),r.a.createElement("p",null,"Checking address: ",a),r.a.createElement("div",null,"Querying dfuse API for ERC20 Approvals, getting page ",s+1,"...")))):o?r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(w.a,{error:!0,icon:!0,size:"huge"},r.a.createElement(E.a,{name:"exclamation triangle"}),r.a.createElement(w.a.Content,null,r.a.createElement(w.a.Header,null,"Error"),o))):""===a?r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(w.a,{info:!0,icon:!0,size:"huge"},r.a.createElement(E.a,{name:"info"}),r.a.createElement(w.a.Content,null,r.a.createElement(w.a.Header,null,"Enter an address to start!")))):0===i.length?r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(w.a,{success:!0,icon:!0,size:"huge"},r.a.createElement(E.a,{name:"info"}),r.a.createElement(w.a.Content,null,r.a.createElement(w.a.Header,null,"No Approvals"),"Address ",a," has no Approvals."))):r.a.createElement(r.a.Fragment,null,i)},Y=a(1059),Q=function(e){var t=e.showZeroAllowances,a=e.toggleShowZeroAllowances,n=e.addressFilterValue,c=e.handleAddressFilterChange,l=e.clearAddressFilter;return r.a.createElement(I.a,{verticalAlign:"middle",centered:!0,textAlign:"center",columns:2,divided:!0},r.a.createElement(I.a.Row,null,r.a.createElement(I.a.Column,{width:8},r.a.createElement(N.a,{label:"Tokenfilter",name:"filter",placeholder:"Enter name, symbol or contract address",onChange:c,value:n,icon:r.a.createElement(E.a,{name:"eraser",circular:!0,link:!0,onClick:l}),fluid:!0})),r.a.createElement(I.a.Column,{width:8},r.a.createElement(Y.a,{toggle:!0,label:"Include zero allowances",checked:t,onChange:a}))))},X="0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925",ee=[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],te=Object(p.createDfuseClient)({apiKey:"web_085aeaac9c520204b1a9dcaa357e5460",network:"mainnet.eth.dfuse.io"}),ae=function(){var e=Object(n.useContext)(k),t=Object(s.g)().address,a=Object(n.useState)(!1),c=Object(m.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)({}),p=Object(m.a)(i,2),b=p[0],f=p[1],g=Object(n.useState)(""),w=Object(m.a)(g,2),E=w[0],v=w[1],y=Object(n.useState)(t?t.toLowerCase():""),O=Object(m.a)(y,2),S=O[0],x=O[1],j=Object(n.useState)(0),C=Object(m.a)(j,2),A=C[0],T=C[1],z=Object(n.useState)(!0),N=Object(m.a)(z,2),I=N[0],F=N[1],D=Object(n.useState)(""),L=Object(m.a)(D,2),H=L[0],B=L[1];return Object(n.useEffect)((function(){x(t?t.toLowerCase():"")}),[t]),Object(n.useEffect)((function(){document.title="TAC - ".concat(S)}),[S]),Object(n.useEffect)((function(){var t=!1,a=function(){var a=Object(d.a)(u.a.mark((function a(){var n,r,c,l,s,i,d;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:o(!0),v(""),T(0),n="",r={},a.prev=5,c=0,l=0,s=[];case 9:return console.log("Getting page ".concat(c,". Last page result: ").concat(l,". Total results so far: ").concat(s.length)),a.next=12,te.graphql("query ($query: String! $limit: Int64! $cursor: String) {\n      searchTransactions(\n        indexName: LOGS, \n        query: $query, \n        limit: $limit, \n        sort: DESC,\n        cursor: $cursor,\n      ) {\n        pageInfo {\n          endCursor\n        }\n        edges {\n          node {\n            block {\n              number\n            }\n            matchingLogs {\n              data\n              topics\n              address\n            }\n          }\n        }\n      }\n    }",{variables:{limit:"50",query:"topic.0:".concat(X," topic.1:").concat(S),cursor:n}});case 12:if(i=a.sent,!t){a.next=16;break}return console.log("Received stale response."),a.abrupt("return");case 16:if(!i.errors){a.next=18;break}throw i.errors;case 18:n=i.data.searchTransactions.pageInfo.endCursor,d=i.data.searchTransactions.edges||[],l=d.length,s=s.concat(d),c++,T(c);case 24:if(l>0){a.next=9;break}case 25:s.forEach((function(t){t.node.matchingLogs.forEach((function(t){if(t.topics[0]===X){if("0x"===t.data)return console.warn("Skipping log event. LogEntry.data is missing:"),void console.warn(t);var a;try{a=e.web3.eth.abi.decodeLog(ee,t.data,t.topics.slice(1))}catch(c){return console.warn("Skipping log event. Failed to decode logEntry:"),void console.warn(t)}if(parseInt(a.spender))if(a.owner.toLowerCase()===S){var n=t.address;Object.keys(r).includes(n)||(r[n]=[]),r[n].includes(a.spender)||r[n].push(a.spender)}else console.warn("Skipping log event due to owner mismatch. Expected ".concat(S,", got ").concat(a.owner,"."));else console.log("Skipping log event. Spender is ".concat(a.spender,"."))}else console.warn("Skipping log event. Topic is wrong, expected ".concat(X,", got ").concat(t.topics[0]))})),f(r)})),a.next=32;break;case 28:a.prev=28,a.t0=a.catch(5),console.log(a.t0),t||v(JSON.stringify(a.t0));case 32:o(!1);case 33:case"end":return a.stop()}}),a,null,[[5,28]])})));return function(){return a.apply(this,arguments)}}();return f({}),e.web3&&S&&a(S),function(){t=!0}}),[e.web3,S]),r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{basic:!0},r.a.createElement("h2",null,"Allowances of ",S,":")),r.a.createElement(Q,{showZeroAllowances:I,toggleShowZeroAllowances:function(){F(!I)},addressFilterValue:H,handleAddressFilterChange:function(e,t){t.name;var a=t.value;B(a)},clearAddressFilter:function(){B("")}}),r.a.createElement(V,{tokenSpenders:b,address:S,showZeroAllowances:I,addressFilter:H,error:E,loading:l,page:A}))},ne=function(e){var t=Object(s.f)(),a=Object(n.useContext)(k),c=Object(n.useState)(!0),l=Object(m.a)(c,2),o=l[0],i=l[1],p=Object(n.useState)(!1),b=Object(m.a)(p,2),f=b[0],g=b[1];return Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,a.loginFunction();case 3:n=e.sent,g(n),i(!1),n||t.push("/");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();a.onboard&&e()}),[a.onboard,t]),f&&a.web3?r.a.createElement(r.a.Fragment,null,e.children):o?r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(w.a,{info:!0,icon:!0,size:"huge"},r.a.createElement(E.a,{name:"spinner",loading:!0}),r.a.createElement(w.a.Content,null,r.a.createElement(w.a.Header,null,"Waiting for wallet"),"Please complete wallet selection.")))):f?void 0:r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(w.a,{warning:!0,icon:!0,size:"huge"},r.a.createElement(E.a,{name:"exclamation triangle"}),r.a.createElement(w.a.Content,null,r.a.createElement(w.a.Header,null,"No wallet selected"),"You need to select a wallet."))))},re=a(1070),ce=a(1062),le=a(1063),oe=a(1067),se=function(e){var t=e.handleInput,a=e.loading,n=e.error,c=e.value,l=e.success,o=function(){var e=Object(d.a)(u.a.mark((function e(a){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.target.value,t(n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(z.a.Field,{inline:!0,width:14},r.a.createElement(N.a,{placeholder:"Address or ENS Name",error:n,loading:a,onChange:o,value:c,type:"text",action:{type:"Submit",disabled:!l,content:"Go!",positive:!0},label:"Enter address/ENS name or select in wallet"}))},ie="address_initial",ue="address_resolving",de="address_valid",me="address_invalid",pe=function(){var e=Object(n.useContext)(k),t=Object(s.g)().address||"",a=Object(s.f)(),c=Object(n.useState)(ie),l=Object(m.a)(c,2),o=l[0],i=l[1],p=Object(n.useState)(t?t.toLowerCase():""),b=Object(m.a)(p,2),f=b[0],g=b[1],h=Object(n.useState)(""),w=Object(m.a)(h,2),E=w[0],v=w[1],y=Object(n.useState)(e.address?e.address.toLowerCase():""),O=Object(m.a)(y,2),S=O[0],x=O[1];Object(n.useEffect)((function(){(function(){var t=Object(d.a)(u.a.mark((function t(){var a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==f.length){t.next=4;break}i(ie),t.next=24;break;case 4:if(a=/^(0x)?[0-9a-f]{40}$/i.test(f),!/.*\.eth$/i.test(f)){t.next=23;break}return i(ue),t.prev=8,t.next=11,e.web3.eth.ens.getAddress(f);case 11:n=t.sent,console.log("Resolved ".concat(f," to ").concat(n)),i(de),v(n),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(8),console.log("Could not resolve "+f),i(me);case 21:t.next=24;break;case 23:a?(v(f),i(de)):i(me);case 24:case"end":return t.stop()}}),t,null,[[8,17]])})));return function(){return t.apply(this,arguments)}})()()}),[f,v,e.web3]),Object(n.useEffect)((function(){var n=e.address?e.address.toLowerCase():"";""!==n&&(""!==t&&n===S||(g(n),x(n),a.push("/address/".concat(n))))}),[e.address,S,t,a]);var j=o===me,C=o===ue,A=o===de;return r.a.createElement(I.a,{textAlign:"center",centered:!0,columns:1},r.a.createElement(I.a.Row,null,r.a.createElement(I.a.Column,{width:14},r.a.createElement(z.a,{size:"huge",onSubmit:function(){A?(console.log("Submit! Address: ".concat(E)),a.push("/address/".concat(E))):console.log("Submit with invalid address")},error:j,success:A,widths:"equal"},r.a.createElement(z.a.Group,null,r.a.createElement(se,{handleInput:g,value:f,error:j,success:A,loading:C}))))))},be=a(478),fe=function(){var e=r.a.createElement(h.a,{inverted:!1,textAlign:"center",vertical:!0},r.a.createElement(re.a,{fixed:"top",inverted:!0,size:"huge"},r.a.createElement(ce.a,null,r.a.createElement(re.a.Item,{header:!0,as:o.b,to:"/"},r.a.createElement(E.a,{name:"home",size:"big"})," Home"),r.a.createElement(re.a.Item,{as:o.b,to:"/address/"},r.a.createElement(E.a,{name:"search",size:"big"})," Check Allowances"),r.a.createElement(re.a.Menu,{position:"right"},r.a.createElement(re.a.Item,null,r.a.createElement("a",{href:"https://github.com/TripleSpeeder/token-allowance-checker",title:"github.com/TripleSpeeder/token-allowance-checker",target:"_blank",rel:"noopener noreferrer"},r.a.createElement(E.a,{name:"github",size:"big"})))))),r.a.createElement(ce.a,{text:!0,style:{marginTop:"4em",marginBottom:"2em"}},r.a.createElement(T.a,{as:"h1",inverted:!1,style:{fontSize:"3em",marginTop:"0.5em"}},"Token Allowance Checker",r.a.createElement(T.a.Subheader,null,"powered by ",r.a.createElement("a",{href:"https://www.dfuse.io/",rel:"noopener noreferrer",target:"_blank"},"dfuse")))));return r.a.createElement(o.a,null,e,r.a.createElement(O,null,r.a.createElement(s.c,null,r.a.createElement(s.a,{path:["/address/:address","/address"]},r.a.createElement(ce.a,null,r.a.createElement(ne,null,r.a.createElement(h.a,{basic:!0,padded:!0},r.a.createElement(pe,null)),r.a.createElement(ae,null)))),r.a.createElement(s.a,{path:"/"},r.a.createElement(h.a,{basic:!0,vertical:!0,style:{paddingTop:"4em"}},r.a.createElement(I.a,{container:!0,stackable:!0,verticalAlign:"top"},r.a.createElement(I.a.Row,null,r.a.createElement(I.a.Column,{width:8},r.a.createElement(T.a,{as:"h3",style:{fontSize:"2em"}},"Do you actually know who can spend your tokens?"),r.a.createElement("p",{style:{fontSize:"1.33em"}},r.a.createElement("em",null,"Token Allowance Checker")," helps you keep track of which contracts you have approved to spend your tokens."),r.a.createElement(T.a,{as:"h3",style:{fontSize:"2em"}},"Control your approvals"),r.a.createElement("p",{style:{fontSize:"1.33em"}},r.a.createElement("em",null,"Token Allowance Checker")," will show you all approvals for ERC20-compliant tokens, and the option to change the approved amount - or completely zero it.")),r.a.createElement(I.a.Column,{floated:"right",width:7},r.a.createElement(T.a,{as:"h3",style:{fontSize:"2em"}},"The unlimited approval problem"),r.a.createElement("p",{style:{fontSize:"1.33em"}},"Many DApps have the habit of requiring you to approve effectively unlimited amount of tokens. This helps improving the user experience, as you only have to sign off an approval once and it will be enough for all future transactions."),r.a.createElement("p",{style:{fontSize:"1.33em"}},"However this also means that the DApp (or the person/entity controlling it) can at any time transfer ",r.a.createElement("em",null,"all of your tokens"),", without requiring any further approval."),r.a.createElement("p",{style:{fontSize:"1.33em"}},"In addition, there is no concept of expiring approvals. Once approved, the approval will remain forever. If you do not trust a DApp or its operators anymore, there is usually no easy way to remove the approval."))))),r.a.createElement(h.a,{basic:!0,textAlign:"center"},r.a.createElement(L.a,{as:o.b,to:"/address/",primary:!0,size:"massive"},"Check Allowances",r.a.createElement(E.a,{name:"right arrow"})))))),r.a.createElement(h.a,{basic:!0},r.a.createElement(le.a,null),r.a.createElement(ce.a,{textAlign:"center"},r.a.createElement("span",{style:{fontSize:"1em",float:"right"}},r.a.createElement(E.a,{name:"copyright outline"})," Michael Bauer"),r.a.createElement(oe.a,{horizontal:!0},r.a.createElement(oe.a.Item,{as:"a",href:"https://twitter.com/TripleSpeeder",target:"_blank"},r.a.createElement(R.a,{content:"@triplespeeder",trigger:r.a.createElement(E.a,{size:"big",name:"twitter"})})),r.a.createElement(oe.a.Item,{as:"a",href:"https://t.me/triplespeeder",target:"_blank"},r.a.createElement(R.a,{content:"@triplespeeder",trigger:r.a.createElement(E.a,{size:"big",name:"telegram"})})),r.a.createElement(oe.a.Item,{as:"a",href:"mailto:michael@m-bauer.org"},r.a.createElement(R.a,{content:"michael@m-bauer.org",trigger:r.a.createElement(E.a,{size:"big",name:"mail outline"})})),r.a.createElement(oe.a.Item,{as:"a",href:"https://github.com/TripleSpeeder",target:"_blank"},r.a.createElement(R.a,{content:"github.com/TripleSpeeder",trigger:r.a.createElement(E.a,{size:"big",name:"github"})})),r.a.createElement(oe.a.Item,{as:"a",href:"https://www.reddit.com/u/TripleSpeeder",target:"_blank"},r.a.createElement(R.a,{content:"u/TripleSpeeder",trigger:r.a.createElement(E.a,{size:"big",name:"reddit"})}))),r.a.createElement("span",{style:{fontSize:"1em",float:"left"}},be.version))))};l.a.render(r.a.createElement(fe,null),document.getElementById("root"))},478:function(e){e.exports=JSON.parse('{"name":"TAC","version":"1.3.1","private":true,"homepage":"https://tac.dappstar.io","repository":"github:TripleSpeeder/token-allowance-checker","husky":{"hooks":{"commit-msg":"commitlint -E HUSKY_GIT_PARAMS"}},"scripts":{"start":"react-scripts start","start:https":"HTTPS=true react-scripts start","build":"PUBLIC_URL=\'.\' react-scripts build","test":"react-scripts test","eject":"react-scripts eject","storybook":"start-storybook -p 9009 -s public","build-storybook":"build-storybook -s public","release":"standard-version"},"dependencies":{"@dfuse/client":"^0.3.8","@openzeppelin/contracts":"^2.5.0","@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.4.0","@testing-library/user-event":"^7.2.1","@triplespeeder/bn2string":"^1.0.0","@truffle/contract":"^4.1.8","bn.js":"^5.1.1","bnc-onboard":"^1.3","eth-ens-namehash":"^2.0.8","prop-types":"^15.7.2","react":"^16.12.0","react-dom":"^16.12.0","react-router-dom":"^5.1.2","react-scripts":"3.4.0","semantic-ui-css":"^2.4.1","semantic-ui-react":"^0.88.2","use-clippy":"^1.0.5","web3":"^1.2.6"},"devDependencies":{"@commitlint/cli":"^8.3.5","@commitlint/config-conventional":"^8.3.4","@semantic-release/changelog":"^5.0.0","@semantic-release/git":"^9.0.0","@storybook/addon-actions":"^5.3.12","@storybook/addon-links":"^5.3.12","@storybook/addons":"^5.3.12","@storybook/preset-create-react-app":"^1.5.2","@storybook/react":"^5.3.12","gh-pages":"^2.2.0","husky":"^4.2.3","semantic-release":"^17.0.4","standard-version":"^7.1.0"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},496:function(e,t,a){e.exports=a(1028)},501:function(e,t,a){},502:function(e,t,a){},512:function(e,t){},530:function(e,t){},532:function(e,t){},598:function(e,t){},600:function(e,t){},601:function(e,t){},607:function(e,t){},609:function(e,t){},626:function(e,t){},629:function(e,t){},645:function(e,t){},648:function(e,t){},664:function(e,t){},665:function(e,t){},667:function(e,t){},781:function(e,t){},933:function(e,t){},940:function(e,t){},957:function(e,t){},969:function(e,t){},972:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=972},978:function(e,t){}},[[496,2,3]]]);
//# sourceMappingURL=main.417fb9a7.chunk.js.map