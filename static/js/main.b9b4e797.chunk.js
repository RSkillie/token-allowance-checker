(this.webpackJsonpTAC=this.webpackJsonpTAC||[]).push([[1],{1004:function(e,t){},1028:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(91),l=a.n(c),o=(a(501),a(502),a(71)),s=a(75),i=a(8),u=a.n(i),d=a(33),m=a(17),p=a(476),b=a(452),f=a(261),g=a.n(f),h=a(1071),E=a(1069),w=a(61),v=Object(n.createContext)({onboard:null,web3:null,address:null,networkId:null,loggedIn:!1,loginFunction:null}),k=[{walletName:"metamask",preferred:!0},{walletName:"coinbase",preferred:!0},{walletName:"walletConnect",infuraKey:"7f230a5ca832426796454c28577d93f2",preferred:!0},{walletName:"trust",preferred:!0},{walletName:"dapper",preferred:!0},{walletName:"authereum",preferred:!0},{walletName:"opera"},{walletName:"status"},{walletName:"operaTouch"},{walletName:"torus"},{walletName:"status"}],y=function(e){var t=Object(n.useState)(),a=Object(m.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(),s=Object(m.a)(o,2),i=s[0],p=s[1],f=Object(n.useState)(),y=Object(m.a)(f,2),O=y[0],j=y[1],x=Object(n.useState)(),S=Object(m.a)(x,2),C=S[0],A=S[1],T=Object(n.useState)(!1),z=Object(m.a)(T,2),N=z[0],I=z[1],F=Object(n.useState)(!1),L=Object(m.a)(F,2),D=L[0],H=L[1];Object(n.useEffect)((function(){console.log("Initializing OnBoard.js...");var e=Object(b.a)({dappId:"f4b71bf0-fe50-4eeb-bc2b-b323527ed9e6",networkId:1,subscriptions:{wallet:function(e){console.log("".concat(e.name," is now connected!")),l(new g.a(e.provider))},address:function(e){p(e),console.log("Address changed to ".concat(e,"!"))},network:function(e){j(e),console.log("NetworkId change to ".concat(e))}},walletSelect:{wallets:k}});A(e)}),[]);var _=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=14;break}if(D){e.next=10;break}return console.log("Selecting wallet..."),e.next=5,C.walletSelect();case 5:return t=e.sent,H(t),e.abrupt("return",t);case 10:return console.log("Wallet already selected."),e.abrupt("return",!0);case 12:e.next=16;break;case 14:return console.log("Trying select wallet without onboard"),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=20;break}if(D){e.next=7;break}return e.next=4,_();case 4:if(e.sent){e.next=7;break}return e.abrupt("return",!1);case 7:if(N){e.next=16;break}return console.log("logging in"),e.next=11,C.walletCheck();case 11:return t=e.sent,I(t),e.abrupt("return",t);case 16:return console.log("already logged in"),e.abrupt("return",!0);case 18:e.next=22;break;case 20:return console.log("Trying login without onboard"),e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R={onboard:C,web3:c,address:i,networkId:O,loginFunction:B,selectFunction:_};return C?r.a.createElement(v.Provider,{value:R},e.children):(console.log("Onboard not yet initialized!"),r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(E.a,{info:!0,icon:!0,size:"huge"},r.a.createElement(w.a,{name:"spinner",loading:!0}),r.a.createElement(E.a.Content,null,r.a.createElement(E.a.Header,null,"Initializing web3"),"Please wait while initializing web3 connection.")))))},O=(a(780),a(455)),j=a(1061),x=a(1068),S=a(1066),C=a(1029),A=a(1073),T=function(e){var t=e.address,a=e.ensName,n=function(){navigator.clipboard.writeText(t).then((function(){}),(function(){console.log("failed to set clipboard")}))};return a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,a),r.a.createElement("div",null,r.a.createElement("small",null,t,"\xa0",r.a.createElement(S.a,{mouseEnterDelay:500,content:"Copy to clipboard",trigger:r.a.createElement(w.a,{circular:!0,name:"copy outline",size:"small",onClick:function(){n()}})}),r.a.createElement(S.a,{mouseEnterDelay:500,content:"View on Etherscan",trigger:r.a.createElement(w.a,{circular:!0,name:"external square",size:"small",onClick:function(){window.open("https://etherscan.io/address/".concat(t),"_blank")}})})))):r.a.createElement("div",null,t,"\xa0",r.a.createElement(S.a,{mouseEnterDelay:500,content:"Copy to clipboard",trigger:r.a.createElement(w.a,{circular:!0,name:"copy outline",size:"small",onClick:function(){n()}})}),r.a.createElement(S.a,{mouseEnterDelay:500,content:"View on Etherscan",trigger:r.a.createElement(w.a,{circular:!0,name:"external square",size:"small",onClick:function(){window.open("https://etherscan.io/address/".concat(t),"_blank")}})}))},z=a(51),N=a.n(z),I=a(143),F=a.n(I);function L(e,t,a){if(!("string"===typeof(n=e)||n instanceof String))throw new Error("Pass strings to prevent floating point precision issues.");var n,r=new a(10).pow(new a(t)),c="-"===e.substring(0,1);if(c&&(e=e.substring(1)),"."===e)throw new Error("Invalid value ".concat(e," cannot be converted to")+" base unit with ".concat(t," decimals."));var l=e.split(".");if(l.length>2)throw new Error("Too many decimal points");var o=l[0],s=l[1];if(o||(o="0"),s||(s="0"),s.length>t)throw new Error("Too many decimal places");for(;s.length<t;)s+="0";o=new a(o),s=new a(s);var i=o.mul(r).add(s);return c&&(i=i.neg()),new a(i.toString(10),10)}var D=a(1065),H=a(1064),_=a(1060),B=a(1072),R=function(e){var t=e.showModal,a=e.tokenName,n=e.tokenAddress,c=e.spenderAddress,l=e.currentAllowance,o=e.newAllowance,s=e.handleClose,i=e.handleSubmit,u=e.handleChange,d=a;return""===d&&(d="Unnamed ERC20 at ".concat(n)),r.a.createElement(D.a,{open:t,size:"small",onClose:s},r.a.createElement(A.a,null,"Edit Allowance"),r.a.createElement(D.a.Content,null,r.a.createElement(E.a,{size:"huge"},r.a.createElement(E.a.List,null,r.a.createElement(E.a.Item,null,"Token: ",d),r.a.createElement(E.a.Item,null,"Spender: ",c),r.a.createElement(E.a.Item,null,"Current allowance: ",l))),r.a.createElement(H.a,{size:"huge",onSubmit:i},r.a.createElement(H.a.Field,{required:!0},r.a.createElement(_.a,{label:{tag:!0,content:"Set new allowance"},labelPosition:"right",placeholder:"Enter amount",type:"number",name:"newAllowance",onChange:u,value:o})),r.a.createElement(B.a,{columns:2},r.a.createElement(B.a.Row,null,r.a.createElement(B.a.Column,null,r.a.createElement(H.a.Button,{type:"button",fluid:!0,size:"huge",negative:!0,onClick:s},"Cancel")),r.a.createElement(B.a.Column,null,r.a.createElement(H.a.Button,{type:"submit",fluid:!0,size:"huge",positive:!0},"Okay")))))))},q=function(e){var t=e.handleSubmit,a=e.handleClose,c=e.tokenDecimals,l=e.tokenSupply,o=e.tokenName,s=e.allowance,i=e.spender,u=e.tokenSymbol,d=e.tokenAddress,p=Object(n.useContext)(v),b=Object(n.useState)(""),f=Object(m.a)(b,2),g=f[0],h=f[1],E=Object(n.useCallback)((function(){return s.gte(l)?"unlimited":F()({value:s,decimals:c,roundToDecimals:p.web3.utils.toBN(2)}).rounded}),[s,c,l,p]);return r.a.createElement(R,{currentAllowance:E(),handleClose:a,spenderAddress:i,showModal:!0,tokenName:o,handleChange:function(e,t){var a=t.name,n=t.value;console.log("handleChange: ".concat(a," - ").concat(n)),parseFloat(n)<0&&(n="0"),h(n)},handleSubmit:function(){var e=L(g,c,p.web3.utils.BN);t(e)},tokenSymbol:u,tokenAddress:d,newAllowance:g})},M=function(e){var t,a=e.showModal,n=e.isConfirming,c=e.transactionHash,l=e.error,o=e.handleClose;return l?t=r.a.createElement(E.a,{error:!0,icon:!0},r.a.createElement(w.a,{name:"exclamation triangle"}),r.a.createElement(E.a.Content,null,r.a.createElement(E.a.Header,null,"Error"),l)):c?t=r.a.createElement(E.a,{success:!0,icon:!0},r.a.createElement(w.a,{name:"checkmark"}),r.a.createElement(E.a.Content,null,r.a.createElement(E.a.Header,null,"Allowance changed"),r.a.createElement("p",null,"The new allowance is now set."),r.a.createElement("p",null,"Transaction Hash: ",c))):n&&(t=r.a.createElement(E.a,{icon:!0,info:!0},r.a.createElement(w.a,{name:"spinner",loading:!0}),r.a.createElement(E.a.Content,null,r.a.createElement(E.a.Header,null,"Waiting for confirmation"),"Transaction is being processed..."))),r.a.createElement(D.a,{open:a,size:"small",onClose:o},r.a.createElement(D.a.Content,null,t),!n&&r.a.createElement(D.a.Actions,null,r.a.createElement(C.a,{onClick:o},"Dismiss")))},P=new N.a(2).pow(new N.a(256)).subn(1),Z=function(e){var t=e.tokenName,a=e.tokenAddress,c=e.tokenDecimals,l=e.tokenSupply,o=e.tokenSymbol,s=e.tokenContractInstance,i=e.ownerBalance,p=e.owner,b=e.spenders,f=e.spenderENSNames,g=e.allowances,E=e.showZeroAllowances,w=Object(n.useContext)(v),k=Object(n.useState)(""),y=Object(m.a)(k,2),O=y[0],z=y[1],I=Object(n.useState)(!1),L=Object(m.a)(I,2),D=L[0],H=L[1],_=Object(n.useState)(!1),B=Object(m.a)(_,2),R=B[0],Z=B[1],U=Object(n.useState)(""),$=Object(m.a)(U,2),G=$[0],K=$[1],W=Object(n.useState)(""),J=Object(m.a)(W,2),V=J[0],Y=J[1],Q=Object(n.useState)(!1),X=Object(m.a)(Q,2),ee=X[0],te=X[1],ae=function(){var e=Object(d.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.loginFunction();case 2:if(e.sent){e.next=8;break}return console.log("User failed to login. Cant create transaction."),e.abrupt("return");case 8:console.log("User successfully logged into wallet");case 9:return console.log("Setting new allowance ".concat(t," for ").concat(O)),K(""),Y(""),H(!1),Z(!0),te(!0),e.prev=15,e.next=18,s.approve(O,t.toString(),{from:w.address});case 18:a=e.sent,Y(a.tx),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(15),console.log("Error while approving: ".concat(e.t0.message)),K(e.t0.message);case 26:te(!1);case 27:case"end":return e.stop()}}),e,null,[[15,22]])})));return function(t){return e.apply(this,arguments)}}(),ne=[],re=!0,ce=!1,le=void 0;try{for(var oe,se=function(){var e=oe.value,t=void 0,n=!1,o=!1,s=void 0;if(N.a.isBN(g[e])&&N.a.isBN(c)&&N.a.isBN(l))if(s=g[e],o=p.toLowerCase()===w.address.toLowerCase(),n=s.eq(P)||s.gte(l))t=r.a.createElement("em",null,"unlimited");else{var i=c,u=new N.a(2),d=F()({value:s,decimals:i,roundToDecimals:u}).rounded;t="".concat(d)}else t=r.a.createElement(j.a,{active:!0,inline:!0,size:"mini"});s&&s.isZero()&&!E||ne.push(r.a.createElement(x.a.Row,{key:"".concat(a,"-").concat(e)},r.a.createElement(x.a.Cell,null,r.a.createElement(T,{address:e,ensName:f[e]})),r.a.createElement(x.a.Cell,{negative:n},t),r.a.createElement(x.a.Cell,null,r.a.createElement(S.a,{content:o?"edit allowance":"Only address owner can edit allowance",trigger:r.a.createElement("span",null,r.a.createElement(C.a,{icon:"edit",size:"small",compact:!0,primary:!0,disabled:!o,onClick:function(){!function(e){z(e),H(!0)}(e)}}))}))))},ie=b[Symbol.iterator]();!(re=(oe=ie.next()).done);re=!0)se()}catch(be){ce=!0,le=be}finally{try{re||null==ie.return||ie.return()}finally{if(ce)throw le}}if(0===ne.length)return null;var ue=t;""===ue&&(ue="Unnamed ERC20");var de=new N.a(2);if(N.a.isBN(i)&&N.a.isBN(c)){var me=F()({value:i,decimals:c,roundToDecimals:de}).rounded;ue+=" (current balance: ".concat(me,")")}var pe=r.a.createElement(T,{address:a,ensName:ue});return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{raised:!0},r.a.createElement(A.a,{as:"h3"},pe),r.a.createElement(x.a,{basic:"very",celled:!0,selectable:!0},r.a.createElement(x.a.Header,null,r.a.createElement(x.a.Row,null,r.a.createElement(x.a.HeaderCell,null,"Spender"),r.a.createElement(x.a.HeaderCell,null,"Allowance"),r.a.createElement(x.a.HeaderCell,null,"Action"))),r.a.createElement(x.a.Body,null,ne))),D&&r.a.createElement(q,{spender:O,tokenDecimals:c,allowance:g[O],tokenSymbol:o,tokenName:t,tokenSupply:l,tokenAddress:a,handleSubmit:ae,handleClose:function(){H(!1)}}),R&&r.a.createElement(M,{showModal:R,isConfirming:ee,handleClose:function(){Z(!1)},error:G,transactionHash:V}))},U={1:{"0x89d24a6b4ccb1b6faa2625fe562bdd9a23260359":{name:"Sai Stablecoin",symbol:"SAI"},"0x9f8f72aa9304c8b593d555f12ef6589cc3a579a2":{name:"Maker Token",symbol:"MKR"},"0xecf8f87f810ecf450940c9f60066b4a7a501d6a7":{name:"Old Wrapped Ether",symbol:"WETH"},"0xc66ea802717bfb9833400264dd12c2bceaa34a6d":{name:"Old Maker Token",symbol:"MKR"},"0xbb9bc244d798123fde783fcc1c72d3bb8c189413":{name:"TheDAO Token",symbol:"TheDAO"}}},$=a(885),G=a(83),K=function(e){var t=e.contractAddress,a=e.owner,c=e.spenders,l=e.showZeroAllowances,o=e.addressFilter,s=Object(n.useContext)(v),i=Object(n.useState)(null),p=Object(m.a)(i,2),b=p[0],f=p[1],g=Object(n.useState)(),h=Object(m.a)(g,2),E=h[0],w=h[1],k=Object(n.useState)(),y=Object(m.a)(k,2),j=y[0],x=y[1],S=Object(n.useState)(""),C=Object(m.a)(S,2),A=C[0],T=C[1],z=Object(n.useState)(""),N=Object(m.a)(z,2),I=N[0],F=N[1],L=Object(n.useState)({}),D=Object(m.a)(L,2),H=D[0],_=D[1],B=Object(n.useState)(!0),R=Object(m.a)(B,2)[1],q=Object(n.useState)({}),M=Object(m.a)(q,2),P=M[0],K=M[1],W=Object(n.useState)(),J=Object(m.a)(W,2),V=J[0],Y=J[1],Q=Object(n.useState)(!0),X=Object(m.a)(Q,2),ee=X[0],te=X[1];Object(n.useEffect)((function(){var e=!1;return function(){var n=Object(d.a)(u.a.mark((function n(){var r,l,o,i,d,m,p,b,g,h,E,v,k,y,j,S;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return R(!0),r=!0,(l=$(O)).setProvider(s.web3.currentProvider),n.next=6,l.at(t);case 6:if(o=n.sent,i="",d="",!Object.keys(U[s.networkId]).includes(t.toLowerCase())){n.next=14;break}i=U[s.networkId][t.toLowerCase()].name,d=U[s.networkId][t.toLowerCase()].symbol,n.next=26;break;case 14:return n.prev=14,n.next=17,o.name();case 17:return i=n.sent,n.next=20,o.symbol();case 20:d=n.sent,n.next=26;break;case 23:n.prev=23,n.t0=n.catch(14),console.warn("Failed to get name/symbol of contract at ".concat(t,". Please raise\n                    an issue to add this token at https://github.com/TripleSpeeder/token-allowance-checker/issues!"));case 26:return m=s.web3.utils.toBN("0"),n.prev=27,n.next=30,o.decimals();case 30:m=n.sent,n.next=36;break;case 33:n.prev=33,n.t1=n.catch(27),console.warn("Contract at ".concat(t," does not provide decimals(). Assuming 0."));case 36:return n.prev=36,n.next=39,o.totalSupply();case 39:return p=n.sent,n.next=42,o.balanceOf(a);case 42:b=n.sent,n.next=49;break;case 45:n.prev=45,n.t2=n.catch(36),console.warn("Contract at ".concat(t," is not ERC20. Ignoring.")),r=!1;case 49:if(!e){n.next=51;break}return n.abrupt("return");case 51:if(te(r),f(o),w(m),x(p),Y(b),T(i),F(d),g={},!r){n.next=91;break}h=!0,E=!1,v=void 0,n.prev=63,k=c[Symbol.iterator]();case 65:if(h=(y=k.next()).done){n.next=76;break}return j=y.value,n.next=69,o.allowance(a,j);case 69:if(S=n.sent,!e){n.next=72;break}return n.abrupt("return");case 72:g[j]=S;case 73:h=!0,n.next=65;break;case 76:n.next=82;break;case 78:n.prev=78,n.t3=n.catch(63),E=!0,v=n.t3;case 82:n.prev=82,n.prev=83,h||null==k.return||k.return();case 85:if(n.prev=85,!E){n.next=88;break}throw v;case 88:return n.finish(85);case 89:return n.finish(82);case 90:_(g);case 91:R(!1);case 92:case"end":return n.stop()}}),n,null,[[14,23],[27,33],[36,45],[63,78,82,90],[83,,85,89]])})));return function(){return n.apply(this,arguments)}}()(),function(){e=!0}}),[s.web3,s.networkId,t,a,c]),Object(n.useEffect)((function(){var e=!1,t=function(){var t=Object(d.a)(u.a.mark((function t(a){var n,r,l,o,s,i,d,m,p,b,f;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n={},r=!0,l=!1,o=void 0,t.prev=4,s=c[Symbol.iterator]();case 6:if(r=(i=s.next()).done){t.next=25;break}return d=i.value,t.prev=8,m=d.toLowerCase().substr(2)+".addr.reverse",t.next=12,a.eth.ens.resolver(m);case 12:return p=t.sent,b=G.hash(m),t.next=16,p.methods.name(b).call();case 16:f=t.sent,n[d]=f,t.next=22;break;case 20:t.prev=20,t.t0=t.catch(8);case 22:r=!0,t.next=6;break;case 25:t.next=31;break;case 27:t.prev=27,t.t1=t.catch(4),l=!0,o=t.t1;case 31:t.prev=31,t.prev=32,r||null==s.return||s.return();case 34:if(t.prev=34,!l){t.next=37;break}throw o;case 37:return t.finish(34);case 38:return t.finish(31);case 39:if(!e){t.next=41;break}return t.abrupt("return");case 41:K(n);case 42:case"end":return t.stop()}}),t,null,[[4,27,31,39],[8,20],[32,,34,38]])})));return function(e){return t.apply(this,arguments)}}();return s.web3&&t(s.web3),function(){e=!0}}),[s.web3,c]);var ae=!0;if(o.length){var ne=o.toLowerCase();ae=A.toLowerCase().includes(ne)||I.toLowerCase().includes(ne)||t.toLowerCase().includes(ne)}return ee&&ae?r.a.createElement(Z,{tokenName:A,tokenAddress:t,tokenDecimals:E,tokenSupply:j,tokenSymbol:I,owner:a,ownerBalance:V,spenders:c,spenderENSNames:P,allowances:H,tokenContractInstance:b,showZeroAllowances:l,addressFilter:o}):null},W=function(e){for(var t=e.tokenSpenders,a=e.address,n=e.showZeroAllowances,c=e.addressFilter,l=e.loading,o=e.error,s=e.page,i=[],u=0,d=Object.entries(t);u<d.length;u++){var p=Object(m.a)(d[u],2),b=p[0],f=p[1];i.push(r.a.createElement(K,{key:b,owner:a,spenders:f,contractAddress:b,showZeroAllowances:n,addressFilter:c}))}return l?r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(E.a,{icon:!0,warning:!0,size:"huge"},r.a.createElement(w.a,{name:"circle notched",loading:!0}),r.a.createElement(E.a.Content,null,r.a.createElement(E.a.Header,null,"Please wait while loading events"),r.a.createElement("p",null,"Checking address: ",a),r.a.createElement("div",null,"Querying dfuse API for ERC20 Approvals, getting page ",s+1,"...")))):o?r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(E.a,{error:!0,icon:!0,size:"huge"},r.a.createElement(w.a,{name:"exclamation triangle"}),r.a.createElement(E.a.Content,null,r.a.createElement(E.a.Header,null,"Error"),o))):""===a?r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(E.a,{info:!0,icon:!0,size:"huge"},r.a.createElement(w.a,{name:"info"}),r.a.createElement(E.a.Content,null,r.a.createElement(E.a.Header,null,"Enter an address to start!")))):0===i.length?r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(E.a,{success:!0,icon:!0,size:"huge"},r.a.createElement(w.a,{name:"info"}),r.a.createElement(E.a.Content,null,r.a.createElement(E.a.Header,null,"No Approvals"),"Address ",a," has no Approvals."))):r.a.createElement(r.a.Fragment,null,i)},J=a(1059),V=function(e){var t=e.showZeroAllowances,a=e.toggleShowZeroAllowances,n=e.addressFilterValue,c=e.handleAddressFilterChange,l=e.clearAddressFilter;return r.a.createElement(B.a,{verticalAlign:"middle",centered:!0,textAlign:"center",columns:2,divided:!0},r.a.createElement(B.a.Row,null,r.a.createElement(B.a.Column,{width:8},r.a.createElement(_.a,{label:"Tokenfilter",name:"filter",placeholder:"Enter name, symbol or contract address",onChange:c,value:n,icon:r.a.createElement(w.a,{name:"eraser",circular:!0,link:!0,onClick:l}),fluid:!0,autofocus:!0})),r.a.createElement(B.a.Column,{width:8},r.a.createElement(J.a,{toggle:!0,label:"Include zero allowances",checked:t,onChange:a}))))},Y="0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925",Q=[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],X=Object(p.createDfuseClient)({apiKey:"web_085aeaac9c520204b1a9dcaa357e5460",network:"mainnet.eth.dfuse.io"}),ee=function(){var e=Object(n.useContext)(v),t=Object(s.g)().address,a=Object(n.useState)(!1),c=Object(m.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)({}),p=Object(m.a)(i,2),b=p[0],f=p[1],g=Object(n.useState)(""),E=Object(m.a)(g,2),w=E[0],k=E[1],y=Object(n.useState)(t?t.toLowerCase():""),O=Object(m.a)(y,2),j=O[0],x=O[1],S=Object(n.useState)(0),C=Object(m.a)(S,2),A=C[0],T=C[1],z=Object(n.useState)(!0),N=Object(m.a)(z,2),I=N[0],F=N[1],L=Object(n.useState)(""),D=Object(m.a)(L,2),H=D[0],_=D[1];return Object(n.useEffect)((function(){x(t?t.toLowerCase():"")}),[t]),Object(n.useEffect)((function(){document.title="TAC - ".concat(j)}),[j]),Object(n.useEffect)((function(){var t=!1,a=function(){var a=Object(d.a)(u.a.mark((function a(){var n,r,c,l,s,i,d;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:o(!0),k(""),T(0),n="",r={},a.prev=5,c=0,l=0,s=[];case 9:return console.log("Getting page ".concat(c,". Last page result: ").concat(l,". Total results so far: ").concat(s.length)),a.next=12,X.graphql("query ($query: String! $limit: Int64! $cursor: String) {\n      searchTransactions(\n        indexName: LOGS, \n        query: $query, \n        limit: $limit, \n        sort: DESC,\n        cursor: $cursor,\n      ) {\n        pageInfo {\n          endCursor\n        }\n        edges {\n          node {\n            block {\n              number\n            }\n            matchingLogs {\n              data\n              topics\n              address\n            }\n          }\n        }\n      }\n    }",{variables:{limit:"50",query:"topic.0:".concat(Y," topic.1:").concat(j),cursor:n}});case 12:if(i=a.sent,!t){a.next=16;break}return console.log("Received stale response."),a.abrupt("return");case 16:if(!i.errors){a.next=18;break}throw i.errors;case 18:n=i.data.searchTransactions.pageInfo.endCursor,d=i.data.searchTransactions.edges||[],l=d.length,s=s.concat(d),c++,T(c);case 24:if(l>0){a.next=9;break}case 25:s.length<=0&&console.log("No Approve() calls found for ".concat(j)),s.forEach((function(t){t.node.matchingLogs.forEach((function(t){if(t.topics[0]===Y){var a=e.web3.eth.abi.decodeLog(Q,t.data,t.topics.slice(1));if(a.owner.toLowerCase()===j){var n=t.address;Object.keys(r).includes(n)||(console.log("Adding tokenContract ".concat(n)),r[n]=[]),r[n].includes(a.spender)||(console.log("Adding Spender ".concat(a.spender," for ").concat(n)),r[n].push(a.spender))}else console.log("Skipping log event due to owner mismatch. Expected ".concat(j,", got ").concat(a.owner))}else console.warn("Skipping wrong topic ".concat(t.topics[0]))})),f(r)})),a.next=33;break;case 29:a.prev=29,a.t0=a.catch(5),console.log(a.t0),t||k(JSON.stringify(a.t0));case 33:o(!1);case 34:case"end":return a.stop()}}),a,null,[[5,29]])})));return function(){return a.apply(this,arguments)}}();return f({}),e.web3&&j&&(console.log('Starting query for "'.concat(j,'"')),a(j)),function(){t=!0}}),[e.web3,j]),r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{basic:!0},r.a.createElement("h2",null,"Allowances of ",j,":")),r.a.createElement(V,{showZeroAllowances:I,toggleShowZeroAllowances:function(){F(!I)},addressFilterValue:H,handleAddressFilterChange:function(e,t){t.name;var a=t.value;_(a)},clearAddressFilter:function(){_("")}}),r.a.createElement(W,{tokenSpenders:b,address:j,showZeroAllowances:I,addressFilter:H,error:w,loading:l,page:A}))},te=function(e){var t=Object(s.f)(),a=Object(n.useContext)(v),c=Object(n.useState)(!0),l=Object(m.a)(c,2),o=l[0],i=l[1],p=Object(n.useState)(!1),b=Object(m.a)(p,2),f=b[0],g=b[1];return Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,a.loginFunction();case 3:n=e.sent,g(n),i(!1),n||t.push("/");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();a.onboard&&e()}),[a.onboard,t]),f&&a.web3?r.a.createElement(r.a.Fragment,null,e.children):o?r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(E.a,{info:!0,icon:!0,size:"huge"},r.a.createElement(w.a,{name:"spinner",loading:!0}),r.a.createElement(E.a.Content,null,r.a.createElement(E.a.Header,null,"Waiting for wallet"),"Please complete wallet selection.")))):f?void 0:r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{basic:!0,padded:"very",textAlign:"center"},r.a.createElement(E.a,{warning:!0,icon:!0,size:"huge"},r.a.createElement(w.a,{name:"exclamation triangle"}),r.a.createElement(E.a.Content,null,r.a.createElement(E.a.Header,null,"No wallet selected"),"You need to select a wallet."))))},ae=a(1070),ne=a(1062),re=a(1063),ce=a(1067),le=function(e){var t=e.handleInput,a=e.loading,n=e.error,c=e.value,l=e.success,o=function(){var e=Object(d.a)(u.a.mark((function e(a){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.target.value,t(n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(H.a.Field,{inline:!0,width:14},r.a.createElement(_.a,{placeholder:"Address or ENS Name",error:n,loading:a,onChange:o,value:c,type:"text",action:{type:"Submit",disabled:!l,content:"Go!",positive:!0},label:"Enter address/ENS name or select in wallet"}))},oe="address_initial",se="address_resolving",ie="address_valid",ue="address_invalid",de=function(){var e=Object(n.useContext)(v),t=Object(s.g)().address||"",a=Object(s.f)(),c=Object(n.useState)(oe),l=Object(m.a)(c,2),o=l[0],i=l[1],p=Object(n.useState)(t?t.toLowerCase():""),b=Object(m.a)(p,2),f=b[0],g=b[1],h=Object(n.useState)(""),E=Object(m.a)(h,2),w=E[0],k=E[1],y=Object(n.useState)(e.address?e.address.toLowerCase():""),O=Object(m.a)(y,2),j=O[0],x=O[1];Object(n.useEffect)((function(){(function(){var t=Object(d.a)(u.a.mark((function t(){var a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==f.length){t.next=4;break}i(oe),t.next=24;break;case 4:if(a=/^(0x)?[0-9a-f]{40}$/i.test(f),!/.*\.eth$/i.test(f)){t.next=23;break}return i(se),t.prev=8,t.next=11,e.web3.eth.ens.getAddress(f);case 11:n=t.sent,console.log("Resolved ".concat(f," to ").concat(n)),i(ie),k(n),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(8),console.log("Could not resolve "+f),i(ue);case 21:t.next=24;break;case 23:a?(k(f),i(ie)):i(ue);case 24:case"end":return t.stop()}}),t,null,[[8,17]])})));return function(){return t.apply(this,arguments)}})()()}),[f,k,e.web3]),Object(n.useEffect)((function(){var n=e.address?e.address.toLowerCase():"";""!==n&&(""!==t&&n===j||(g(n),x(n),a.push("/address/".concat(n))))}),[e.address,j,t,a]);var S=o===ue,C=o===se,A=o===ie;return r.a.createElement(B.a,{textAlign:"center",centered:!0,columns:1},r.a.createElement(B.a.Row,null,r.a.createElement(B.a.Column,{width:14},r.a.createElement(H.a,{size:"huge",onSubmit:function(){A?(console.log("Submit! Address: ".concat(w)),a.push("/address/".concat(w))):console.log("Submit with invalid address")},error:S,success:A,widths:"equal"},r.a.createElement(H.a.Group,null,r.a.createElement(le,{handleInput:g,value:f,error:S,success:A,loading:C}))))))},me=a(478),pe=function(){var e=r.a.createElement(h.a,{inverted:!1,textAlign:"center",vertical:!0},r.a.createElement(ae.a,{fixed:"top",inverted:!0,size:"huge"},r.a.createElement(ne.a,null,r.a.createElement(ae.a.Item,{header:!0,as:o.b,to:"/"},r.a.createElement(w.a,{name:"home",size:"big"})," Home"),r.a.createElement(ae.a.Item,{as:o.b,to:"/address/"},r.a.createElement(w.a,{name:"search",size:"big"})," Check Allowances"),r.a.createElement(ae.a.Menu,{position:"right"},r.a.createElement(ae.a.Item,null,r.a.createElement("a",{href:"https://github.com/TripleSpeeder/token-allowance-checker",title:"github.com/TripleSpeeder/token-allowance-checker",target:"_blank",rel:"noopener noreferrer"},r.a.createElement(w.a,{name:"github",size:"big"})))))),r.a.createElement(ne.a,{text:!0,style:{marginTop:"4em",marginBottom:"2em"}},r.a.createElement(A.a,{as:"h1",inverted:!1,style:{fontSize:"3em",marginTop:"0.5em"}},"Token Allowance Checker",r.a.createElement(A.a.Subheader,null,"powered by ",r.a.createElement("a",{href:"https://www.dfuse.io/",rel:"noopener noreferrer",target:"_blank"},"dfuse")))));return r.a.createElement(o.a,null,e,r.a.createElement(y,null,r.a.createElement(s.c,null,r.a.createElement(s.a,{path:["/address/:address","/address"]},r.a.createElement(ne.a,null,r.a.createElement(te,null,r.a.createElement(h.a,{basic:!0,padded:!0},r.a.createElement(de,null)),r.a.createElement(ee,null)))),r.a.createElement(s.a,{path:"/"},r.a.createElement(h.a,{basic:!0,vertical:!0,style:{paddingTop:"4em"}},r.a.createElement(B.a,{container:!0,stackable:!0,verticalAlign:"top"},r.a.createElement(B.a.Row,null,r.a.createElement(B.a.Column,{width:8},r.a.createElement(A.a,{as:"h3",style:{fontSize:"2em"}},"Do you actually know who can spend your tokens?"),r.a.createElement("p",{style:{fontSize:"1.33em"}},r.a.createElement("em",null,"Token Allowance Checker")," helps you keep track of which contracts you have approved to spend your tokens."),r.a.createElement(A.a,{as:"h3",style:{fontSize:"2em"}},"Control your approvals"),r.a.createElement("p",{style:{fontSize:"1.33em"}},r.a.createElement("em",null,"Token Allowance Checker")," will show you all approvals for ERC20-compliant tokens, and the option to change the approved amount - or completely zero it.")),r.a.createElement(B.a.Column,{floated:"right",width:7},r.a.createElement(A.a,{as:"h3",style:{fontSize:"2em"}},"The unlimited approval problem"),r.a.createElement("p",{style:{fontSize:"1.33em"}},"Many DApps have the habit of requiring you to approve effectively unlimited amount of tokens. This helps improving the user experience, as you only have to sign off an approval once and it will be enough for all future transactions."),r.a.createElement("p",{style:{fontSize:"1.33em"}},"However this also means that the DApp (or the person/entity controlling it) can at any time transfer ",r.a.createElement("em",null,"all of your tokens"),", without requiring any further approval."),r.a.createElement("p",{style:{fontSize:"1.33em"}},"In addition, there is no concept of expiring approvals. Once approved, the approval will remain forever. If you do not trust a DApp or its operators anymore, there is usually no easy way to remove the approval."))))),r.a.createElement(h.a,{basic:!0,textAlign:"center"},r.a.createElement(C.a,{as:o.b,to:"/address/",primary:!0,size:"massive"},"Check Allowances",r.a.createElement(w.a,{name:"right arrow"})))))),r.a.createElement(h.a,{basic:!0},r.a.createElement(re.a,null),r.a.createElement(ne.a,{textAlign:"center"},r.a.createElement("span",{style:{fontSize:"1em",float:"right"}},r.a.createElement(w.a,{name:"copyright outline"})," Michael Bauer"),r.a.createElement(ce.a,{horizontal:!0},r.a.createElement(ce.a.Item,{as:"a",href:"https://twitter.com/TripleSpeeder",target:"_blank"},r.a.createElement(S.a,{content:"@triplespeeder",trigger:r.a.createElement(w.a,{size:"big",name:"twitter"})})),r.a.createElement(ce.a.Item,{as:"a",href:"https://t.me/triplespeeder",target:"_blank"},r.a.createElement(S.a,{content:"@triplespeeder",trigger:r.a.createElement(w.a,{size:"big",name:"telegram"})})),r.a.createElement(ce.a.Item,{as:"a",href:"mailto:michael@m-bauer.org"},r.a.createElement(S.a,{content:"michael@m-bauer.org",trigger:r.a.createElement(w.a,{size:"big",name:"mail outline"})})),r.a.createElement(ce.a.Item,{as:"a",href:"https://github.com/TripleSpeeder",target:"_blank"},r.a.createElement(S.a,{content:"github.com/TripleSpeeder",trigger:r.a.createElement(w.a,{size:"big",name:"github"})})),r.a.createElement(ce.a.Item,{as:"a",href:"https://www.reddit.com/u/TripleSpeeder",target:"_blank"},r.a.createElement(S.a,{content:"u/TripleSpeeder",trigger:r.a.createElement(w.a,{size:"big",name:"reddit"})}))),r.a.createElement("span",{style:{fontSize:"1em",float:"left"}},me.version))))};l.a.render(r.a.createElement(pe,null),document.getElementById("root"))},478:function(e){e.exports=JSON.parse('{"name":"TAC","version":"1.1.1","private":true,"homepage":"https://tac.dappstar.io","repository":"github:TripleSpeeder/token-allowance-checker","husky":{"hooks":{"commit-msg":"commitlint -E HUSKY_GIT_PARAMS"}},"scripts":{"start":"react-scripts start","build":"PUBLIC_URL=\'.\' react-scripts build","test":"react-scripts test","eject":"react-scripts eject","storybook":"start-storybook -p 9009 -s public","build-storybook":"build-storybook -s public","deploy":"gh-pages -d build"},"dependencies":{"@dfuse/client":"^0.3.8","@openzeppelin/contracts":"^2.5.0","@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.4.0","@testing-library/user-event":"^7.2.1","@triplespeeder/bn2string":"^1.0.0","@truffle/contract":"^4.1.8","bn.js":"^5.1.1","bnc-onboard":"^1.3","eth-ens-namehash":"^2.0.8","prop-types":"^15.7.2","react":"^16.12.0","react-dom":"^16.12.0","react-router-dom":"^5.1.2","react-scripts":"3.4.0","semantic-ui-css":"^2.4.1","semantic-ui-react":"^0.88.2","use-clippy":"^1.0.5","web3":"^1.2.6"},"devDependencies":{"@commitlint/cli":"^8.3.5","@commitlint/config-conventional":"^8.3.4","@semantic-release/changelog":"^5.0.0","@semantic-release/git":"^9.0.0","@storybook/addon-actions":"^5.3.12","@storybook/addon-links":"^5.3.12","@storybook/addons":"^5.3.12","@storybook/preset-create-react-app":"^1.5.2","@storybook/react":"^5.3.12","gh-pages":"^2.2.0","husky":"^4.2.3","semantic-release":"^17.0.4"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},496:function(e,t,a){e.exports=a(1028)},501:function(e,t,a){},502:function(e,t,a){},512:function(e,t){},530:function(e,t){},532:function(e,t){},598:function(e,t){},600:function(e,t){},601:function(e,t){},607:function(e,t){},609:function(e,t){},626:function(e,t){},629:function(e,t){},645:function(e,t){},648:function(e,t){},664:function(e,t){},665:function(e,t){},667:function(e,t){},827:function(e,t){},933:function(e,t){},940:function(e,t){},957:function(e,t){},969:function(e,t){},972:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=972},978:function(e,t){}},[[496,2,3]]]);
//# sourceMappingURL=main.b9b4e797.chunk.js.map